{{ define "documentation-menu" }}

{{ $currentPage := . }}
{{ $menu := .Params.menu_name }}

<!-- documentation and search start   -->
<div class="responsive-menu is-hidden-desktop is-flex is-justify-content-center">
  <div class="is-flex is-justify-content-space-between is-fullwidth pl-20 pr-20">
    <button class="button">Sidebar</button>
    <button class="button">Menu</button>
    <button class="button">Table of content</button>
    <button class="button p-10"><i class="fa fa-search"></i></button>
  </div>
</div>
<div class="navbar-appscode documentation-menu">
  
  <!-- <div class="navbar-left ml-40">

  </div> -->
  <!-- searchbar component start  -->
  <div class="navbar-right">
   
    <ul>
       <button class="button ac-button inline-button back-button"><span
           class="material-icons-outlined">arrow_back</span>Back</button>
      {{ $sectionMenuId := .Params.section_menu_id }}
      {{ if isset .Params "menu_name" }}
      {{ range (index .Site.Menus .Params.menu_name) }}
      {{ if eq (string .Pre) "dropdown" }}
      <li class="nav-item">
        <button class="link"> {{ .Name }} <i class="fa fa-angle-down"></i></button>


        <!-- mega-menu wrapper start  -->
        <div class="mega-menu-wrapper">
          <div class="mega-menu-inner ac-grid-container">
            <button class="button ac-button inline-button back-button"><span
                class="material-icons-outlined">arrow_back</span>Back</button>
            <!-- product start  -->
            <div class="product-menu database-list">
              {{ range .Children }}
              {{ if ne .Weight -1 }}
              <!-- databases  start  -->
              <a href="{{ .URL }}" class="single-product">
                <div class="product-logo">
                  <img src="/assets/images/products/kubedb/kubedb-icon.png" alt="">
                </div>
                <div class="product-info">
                  <h6>{{ .Name }}</h6>
                  <!-- <p>static content</p> -->
                </div>
                <div class="navigate-icon">
                  <span class="material-icons">
                    arrow_forward
                  </span>
                </div>
              </a>
              <!-- databases  end -->
              {{ else }}
              <a href="{{.URL}}" class="single-product">
                <div class="product-logo">
                  <img src="/assets/images/products/kubedb/kubedb-icon.png" alt="">
                </div>
                <div class="product-info">
                  <h6>{{ .Name }}</h6>
                  <!-- <p>static content</p> -->
                </div>
                <div class="navigate-icon">
                  <span class="material-icons">
                    arrow_forward
                  </span>
                </div>
              </a>
              {{ end }}
              {{ end }}

            </div>
            <!-- product end -->

            <!-- product description start  -->
            <!-- single product description start  -->
            <div class="product-description is-block">
              <div class="video-content">
                <iframe width="560" height="415" src="https://www.youtube.com/embed/egzPGc6Yk_A"
                  title="YouTube video player" frameborder="0"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                  allowfullscreen></iframe>
              </div>
            </div>
            <!-- single product description end  -->
            <!-- product description end -->
          </div>
        </div>
        <!-- mega-menu wrapper end  -->
      </li>
      {{ else }}
      <li class="nav-item">
        <a href="{{ .URL }}" class="{{ if eq $sectionMenuId .Identifier }} is-active {{ end }} link">{{ .Name }}</a>
      </li>
      {{ end }}
      {{ end }}
      {{ end }}
    </ul>
    <div class="ac-searchbar">
      <label for="acSearch">
        <i class="fa fa-search"></i>
      </label>
      <input id="acSearch" type="search" placeholder="Search kubedb documentation!">
    </div>

  </div>
  <!-- searchbar component end -->
</div>
<!-- documentation and search end  -->
{{ end }}

{{ define "main" }}

{{ $currentPage := . }}
{{ $menu := .Params.menu_name }}
{{ $p := (index .Site.Data.products .Site.Params.product_key) }}

<!-- init idx -->
{{ .Scratch.Add "idx" 0 }}

{{ $currentBranch := (index (split .Params.menu_name "_") 1) }}
<!-- documentation area start -->
<div class="documentation-area">
  <!-- documentation area start -->
  <div class="left-sidebar-wrapper">
     <button class="button ac-button inline-button back-button pl-15 is-hidden-desktop"><span
         class="material-icons-outlined">arrow_back</span>Back</button>
    <div class="ac-product-left-sidebar">

      {{ if isset .Params "menu_name" }}
      {{ $sectionMenuId := .Params.section_menu_id }}
      {{ range (index .Site.Menus .Params.menu_name) }}
      {{ if eq $sectionMenuId .Identifier }}
      {{ if .HasChildren }}
      {{ $hasPreDropdown := eq (string .Pre) "dropdown" }}

      {{ $.Scratch.Set "leftMenuHeadline" .Name }}
      {{ range .Children }}
      {{ if and ( and .HasChildren $hasPreDropdown) ($currentPage.HasMenuCurrent $menu .)  }}

      {{ $.Scratch.Set "leftMenuHeadline" .Name }}

      {{ end }}
      {{ end }}
      {{ end }}
      {{ end }}
      {{ end }}
      {{ end }}

      <!-- sidebar menu start -->
      <div class="product-sidebar-menu">
        {{ if isset .Params "menu_name" }}
        {{ $sectionMenuId := .Params.section_menu_id }}

        <!-- first child -> section menu -->
        {{ range (index .Site.Menus .Params.menu_name ) }}

        {{ if eq $sectionMenuId .Identifier }}
        {{ $hasPreDropdown := eq (string .Pre) "dropdown" }}

        <!-- second child -> left menu level 1-->
        {{ range .Children }}

        {{ if .HasChildren }}
        {{ if $hasPreDropdown }}
        {{ if $currentPage.HasMenuCurrent $menu . }}

        {{ range .Children }}
        {{ if .HasChildren }}
        {{ partial "menu/group.html" (dict "uid" $.File.UniqueID "page" $currentPage "menu" $menu "entry" .) }}
        {{ else }}
        {{ partial "menu/leaf.html" (dict "uid" $.File.UniqueID "page" $currentPage "menu" $menu "entry" .) }}
        {{ end }}
        {{ end }}

        {{ end }}
        {{ else }}
        {{ partial "menu/group.html" (dict "uid" $.File.UniqueID "page" $currentPage "menu" $menu "entry" .) }}
        {{ end }}

        {{ else }}
        {{ partial "menu/leaf.html" (dict "uid" $.File.UniqueID "page" $currentPage "menu" $menu "entry" .) }}
        {{ end }}
        <!-- end of menu item rendering -->
        {{ end }}
        <!-- end second child -> left level 1-->

        {{ end }}
        {{ end }}
        <!-- end first child -> section menu -->
        {{ end }}
      </div>
      <!-- sidebar menu end -->
    </div>
  </div>
  <!-- left sidebar area end -->


  <!-- documentation body start  -->
  <div class="documentation-body">
    {{ if not (eq $p.latestVersion $currentBranch) }}
    <article class="message is-danger">
      <div class="message-body">
        {{ $url := urls.Parse (absURL .Permalink) }}
        {{ $nurl := "/docs/latest/" }}
        {{ $nf := replace .File.Path (print "/" $currentBranch "/") (print "/" $p.latestVersion "/") }}
        {{ if fileExists $nf }}
        {{ $nurl = replace $url.Path (print "/" $currentBranch) (print "/" $p.latestVersion) }}
        {{ end }}
        You are looking at the documentation of a prior release. To read the documentation of the latest release, please
        visit <a href="{{ $nurl }}">here</a>.
      </div>
    </article>
    {{ end }}
    <div class="full-info">
      {{ .Content }}
    </div>
  </div>
  <!-- documentation body end -->


  <!-- right sidebar start  -->
  <div class="right-sidebar">
    <div class="right-sidebar-area">
      <!-- search item -->
      <!-- <div class="search-area">
        <form action="#">
          <input id="acSearch" type="text" placeholder="Search..." />
          <button class="search-button">
            <i class="fa fa-search" aria-hidden="true"></i>
          </button>
        </form>
      </div> -->
      <!-- search item end -->

      <!-- table of contents area start -->
      <div class="tbl-of-contents">
        <button class="button ac-button inline-button back-button pl-15 is-hidden-desktop"><span
            class="material-icons-outlined">arrow_back</span>Back</button>
        <h4>What's on this Page</h4>
        {{.TableOfContents}}
      </div>
      <!-- table of contents area end -->
    </div>
  </div>
  <!-- right sidebar end  -->

  <script>
    // kd version dropdown js
    var kdDropdown = document.querySelector(".dropdown");
    var kdDropdownBtn = document.querySelector(".dropdown-trigger");
    kdDropdownBtn.addEventListener("click", function () {
      kdDropdown.classList.toggle("is-active");
    })
  </script>
</div>
<!-- documentation area end -->

<!-- sidebar search area start -->

<!-- overlay start -->
<div class="overlay-bg"></div>
<!-- overlay end -->

<div class="sidebar-search-area">
  <div class="search-area-top">
    <h3>Search</h3>

    <div class="searchbar-area">
      <input type="search" name="search" id="searchbox" placeholder="Search..." />
      <button onclick="queryPage(1)"><i class="fa fa-search" aria-hidden="true"></i></button>
    </div>

    <span id="searchbar-script-container" style="display:none"></span>

    <div class="search-meta-information level">
      <div class="level-left">
      </div>
    </div>
  </div>

  <div class="search-result-wrapper">
  </div>

  <!-- pagination area start -->
  <div class="pagination-area">
    <div class="pagination-list">
    </div>
  </div>
  <!-- pagination area end -->
</div>

<!-- improve page section start  -->
<div class="improve-section-area">
  <div class="container">
    <div class="improve-bg-color">
      <div class="columns">
        {{ $urlToken := (split .File.Path "/") }}
        <div class="column is-6">
          <a
            href="{{ $p.repoURL }}/edit/master/docs/{{ if (gt $urlToken 2) }} {{- range after 2 $urlToken -}}{{.}}/{{- end -}}{{ end }}">Improve
            This Page</a>
        </div>
        <!-- <div class="column is-6 has-text-right">
            <p>Last Update 3 days ago</p>
          </div> -->
      </div>
    </div>
  </div>
</div>
<!-- improve page section end -->

<script type="text/javascript">
  var pageSize = 5;
  var acSearch = document.querySelector("#acSearch");
  var bodyOverlay = document.querySelector(".overlay-bg");
  var sidebarSearch = document.querySelector(".sidebar-search-area");

  acSearch.addEventListener("click", function () {
    bodyOverlay.style.display = "block";
    sidebarSearch.style.right = "0";
    document.getElementById("searchbox").focus();
    bodyOverlay.addEventListener("click", function () {
      bodyOverlay.style.display = "none";
      sidebarSearch.style.right = "-100%";
    });
  });

  function encodeQueryData(data) {
    var ret = [];
    for (var d in data)
      ret.push(encodeURIComponent(d) + '=' + encodeURIComponent(data[d]));
    return ret.join('&');
  }

  document.querySelector(".searchbar-area input[type=search]").addEventListener("keyup", function (event) {
    event.preventDefault();
    if (event.keyCode === 13) {
      queryPage(1);
    }
  });

  function queryPage(idx) {
    var q = document.getElementById("searchbox").value;
    var cx = "{{.Site.Params.search_engine_ID}}";
    var key = "{{.Site.Params.search_api_key}}";
    var imgSize = "small";
    var callback = "renderResult";

    var src = "https://www.googleapis.com/customsearch/v1?" + encodeQueryData({
      q: q,
      cx: cx,
      key: key,
      imgSize: imgSize,
      callback: callback,
      start: (idx - 1) * pageSize + 1,
      num: pageSize,
    });

    var newScript = document.createElement("script");
    newScript.src = src;
    e = document.getElementById("searchbar-script-container");
    var child = e.lastElementChild;
    if (child) {
      e.removeChild(child);
    }
    e.appendChild(newScript);
  }

  function renderSearchResultEntry(e) {
    var out = '<div class="single-search-result">' +
      '<h3><a href="' + e.link + '">' + e.title + '</a></h3>' +
      '<a href="' + e.link + '">' + e.htmlFormattedUrl + '</a>' +
      '<div class="result-description-wrapper">';
    if (e.pagemap && e.pagemap.cse_thumbnail) {
      out += '<div class="result-thumb">' +
        '<img src="' + e.pagemap.cse_thumbnail[0].src + '" alt="" />' +
        '</div>';
    }
    out += '<div class="result-description">' +
      '<p>' +
      e.snippet +
      '</p>' +
      '</div>' +
      '</div>' +
      '</div>';
    return out;
  }

  function renderResult(response) {
    document.querySelector(".search-meta-information .level-left").innerHTML = '<div class="level-left">' +
      '<p>' +
      'About <span class="search-count">' + response.searchInformation.formattedTotalResults +
      '</span> results (<span class="time-count">' + response.searchInformation.formattedSearchTime +
      ' </span>seconds)' +
      '</p>' +
      '</div>';

    if (!response.items) {
      return;
    }

    var searchResultWrapper = document.querySelector(".search-result-wrapper");
    searchResultWrapper.innerHTML = "";

    for (var i = 0; i < response.items.length; i++) {
      searchResultWrapper.innerHTML += renderSearchResultEntry(response.items[i]);
    }

    var pager = '<ul>';
    if (response.queries.previousPage) {
      var pageIndex = Math.floor(response.queries.previousPage[0].startIndex / pageSize) + 1;
      pager += '<li><a href="#" onclick="queryPage(' + pageIndex + ')">Previous</a></li>';
    }
    if (response.queries.request) {
      var pageIndex = Math.floor(response.queries.request[0].startIndex / pageSize) + 1;
      pager += '<li><a href="#" onclick="queryPage(' + pageIndex + ')" class="is-active">' + pageIndex + '</a></li>';
    }
    if (response.queries.nextPage) {
      var pageIndex = Math.floor(response.queries.nextPage[0].startIndex / pageSize) + 1;
      pager += '<li><a href="#" onclick="queryPage(' + pageIndex + ')">Next</a></li>';
    }
    pager += '</ul>';
    document.querySelector(".pagination-area .pagination-list").innerHTML = pager;
  }
</script>

<!-- sidebar search area end -->

{{ end }}

{{ define "testimonial" }}
<section></section>
{{ end }}


{{ define "customer-logos" }}
<section></section>
{{ end }}

{{ define "cta-install" }}
<section></section>
{{ end }}