{{ define "documentation-menu" }}

{{ $currentPage := . }}
{{ $menu := .Params.menu_name }}
<!-- kubeDB bottom menu start -->
<div class="kubedb-documentation-menu">
  <div class="container section">
    <!-- documentation menu area start -->
    <div class="documentation-menu">
      <div class="container section">
        <div class="columns is-centered">
          <div class="column is-half has-text-centered">
            <!-- responsive menu start -->
            <div class="responsive-menu">
              <a
                role="button"
                class="navbar-burger burger"
                aria-label="menu"
                aria-expanded="false"
                data-target="acNav3"
              >
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
              </a>
            </div>
            <!-- responsive menu end -->
            <!-- start -->
            <nav class="documentation-navbar">
              <div id="acNav3" class="navbar-menu nav-menu main-menu">
                <div class="navbar-centered">
                  <!-- nav menu start -->
                  <div class="navbar-start">
                    {{ $sectionMenuId := .Params.section_menu_id }}
                    {{ if isset .Params "menu_name" }}
                      {{ range (index .Site.Menus .Params.menu_name) }}
                        {{ if eq (string .Pre) "dropdown" }}
                          <div class="navbar-item has-dropdown ac-is-hoverable">
                            <a class="navbar-link">
                              {{ .Name }}
                            </a>
                            <div class="ac-dropdown">
                              {{ range .Children }}
                                {{ if ne .Weight -1 }}
                                  <a href="{{ .URL }}" class="navbar-item">{{ .Name }}</a>
                                {{ end }}
                              {{ end }}
                            </div>
                          </div>
                        {{ else }}
                          <a href="{{ .URL }}" class="{{ if eq $sectionMenuId .Identifier }} is-active {{ end }} navbar-item">{{ .Name }}</a>
                        {{ end }}
                      {{ end }}
                    {{ end }}
                  </div>
                  <!-- nav menu end -->
                </div>
              </div>
            </nav>
            <!-- end -->
          </div>
        </div>
      </div>
    </div>
    <!-- documentation menu area end -->
  </div>
</div>
<!-- kubeDB bottom menu end -->
{{ end }}

{{ define "main" }}

{{ $currentPage := . }}
{{ $menu := .Params.menu_name }}
{{ $productJson := (index $.Site.Data.products.products "docs" ) }}
{{ $latestVersion:= (index $.Site.Data.products.products.docs "latestVersion") }}

<!-- init idx -->
{{ .Scratch.Add "idx" 0 }}

<!-- documentation area start -->
<div class="documentation-area">
  <div class="container section">
    <div class="columns">
      <div class="column is-3">
        <!-- left sidebar area start -->
        <div class="kd-left-sidebar">
          <div class="kd-version">
            {{ $currentBranch := (index (split .Params.menu_name "_") 1) }}
            {{ $versions := (index $productJson "versions" ) }}

            <div class="dropdown">
              <div class="dropdown-trigger">
                <button
                  class="button is-fullwidth"
                  aria-haspopup="true"
                  aria-controls="dropdown-menu3"
                >

                  {{ range $version := $versions }}
                    {{ $branch := (index $version "branch") }}
                    {{ if (index $version "v-dropdown") }}
                      {{ if and (index $version "hostDocs") (eq $branch $currentBranch) }}
                  <span><strong class="icon"><i class="fa fa-cog" aria-hidden="true"></i></strong>{{ $branch }}</span>
                      {{ end }}
                    {{ end }}
                  {{ end }}

                  <span class="icon is-small">
                    <i class="fa fa-angle-down" aria-hidden="true"></i>
                  </span>
                </button>
              </div>
              <div class="dropdown-menu" id="dropdown-menu3" role="menu">
                <div class="dropdown-content">
                  {{ range $version := $versions }}
                    {{ $branch := (index $version "branch") }}
                    {{ if (index $version "v-dropdown") }}
                      {{ if (index $version "hostDocs") }}
                        <a href="/docs/{{ $branch }}/" class="dropdown-item">{{ $branch }}  {{ if eq $branch $latestVersion }} <div class="tag">New</div> {{ end }}</a>
                      {{ else }}
                        <a href="https://github.com/{{ index $productJson "docRepo" }}/tree/{{ $branch }}/docs" target="_blank" class="dropdown-item">{{ $branch }}</a>
                      {{ end }}
                    {{ end }}
                  {{ end }}
                </div>
              </div>
            </div>
          </div>

          {{ if isset .Params "menu_name" }}
            {{ $sectionMenuId := .Params.section_menu_id }}
            {{ range (index .Site.Menus .Params.menu_name) }}
              {{ if eq $sectionMenuId .Identifier }}
                {{ if .HasChildren }}
                  {{ $hasPreDropdown := eq (string .Pre) "dropdown" }}

                  {{ $.Scratch.Set "leftMenuHeadline" .Name }}
                  {{ range .Children }}
                    {{ if and ( and .HasChildren $hasPreDropdown) ($currentPage.HasMenuCurrent $menu .)  }}

                      {{ $.Scratch.Set "leftMenuHeadline" .Name }}

                    {{ end }}
                  {{ end }}
                {{ end }}
              {{ end }}
            {{ end }}
          {{ end }}

          <!-- sidebar menu start -->
          <div class="kd-sidebar-menu">
            {{ if isset .Params "menu_name" }}
              {{ $sectionMenuId := .Params.section_menu_id }}

              <!-- first child -> section menu -->
              {{ range (index .Site.Menus .Params.menu_name ) }}

                {{ if eq $sectionMenuId .Identifier }}
                  {{ $hasPreDropdown := eq (string .Pre) "dropdown" }}

                  <!-- second child -> left menu level 1-->
                  {{ range .Children }}

                    {{ if .HasChildren }}
                      {{ if $hasPreDropdown }}
                        {{ if $currentPage.HasMenuCurrent $menu . }}

                            {{ range .Children }}
                              {{ if .HasChildren }}
                                {{ partial "menu/group.html" (dict "uid" $.File.UniqueID "page" $currentPage "menu" $menu "entry" .) }}
                              {{ else }}
                                {{ partial "menu/leaf.html" (dict "uid" $.File.UniqueID "page" $currentPage "menu" $menu "entry" .) }}
                              {{ end }}
                            {{ end }}

                        {{ end }}
                      {{ else }}
                        {{ partial "menu/group.html" (dict "uid" $.File.UniqueID "page" $currentPage "menu" $menu "entry" .) }}
                      {{ end }}

                    {{ else }}
                      {{ partial "menu/leaf.html" (dict "uid" $.File.UniqueID "page" $currentPage "menu" $menu "entry" .) }}
                    {{ end }}
                    <!-- end of menu item rendering -->
                  {{ end }}
                  <!-- end second child -> left level 1-->

                {{ end }}
              {{ end }}
              <!-- end first child -> section menu -->
            {{ end }}
          </div>
          <!-- sidebar menu end -->
        </div>
        <!-- left sidebar area end -->
      </div>
      <div class="column is-7">
        <div class="full-info">
          {{ .Content }}
        </div>
      </div>
      <div class="column is-2">
        <div class="right-sidebar-area">
          <!-- search item -->
          <div class="search-area">
            <form action="#">
              <input type="text" placeholder="Search..." />
              <button class="search-button">
                <i class="fa fa-search" aria-hidden="true"></i>
              </button>
            </form>
          </div>
          <!-- search item end -->

          <!-- table of contents area start -->
          <div class="tbl-of-contents">
            <h4>What's on this Page</h4>
            {{.TableOfContents}}
          </div>
          <!-- table of contents area end -->
        </div>
      </div>
    </div>
  </div>
  <script>
    // kd version dropdown js
    var kdDropdown = document.querySelector(".dropdown");
    var kdDropdownBtn = document.querySelector(".dropdown-trigger");
      kdDropdownBtn.addEventListener("click", function(){
        kdDropdown.classList.toggle("is-active");
      })
  </script>
</div>
<!-- documentation area end -->
{{ end }}

{{ define "testimonial" }}
<section></section>
{{ end }}

{{ define "customer-logos" }}
<section></section>
{{ end }}
