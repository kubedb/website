<!doctype html><html lang=en><head><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-62096468-4','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content="#4D4DCB"><title>KubeDB by AppsCode</title><meta name=description content="KubeDB by AppsCode simplifies and automates routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair for various popular databases on private and public clouds"><meta name=author content="AppsCode Inc."><meta name=keywords content="kubernetes appscode databsse high availability postgres elasticsearch etcd memecached mongodb mysql percona xtradb redis"><link rel=apple-touch-icon sizes=57x57 href=/assets/images/products/kubedb/icons/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/assets/images/products/kubedb/icons/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/assets/images/products/kubedb/icons/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/assets/images/products/kubedb/icons/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/assets/images/products/kubedb/icons/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/assets/images/products/kubedb/icons/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/assets/images/products/kubedb/icons/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/assets/images/products/kubedb/icons/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/assets/images/products/kubedb/icons/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/assets/images/products/kubedb/icons/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/assets/images/products/kubedb/icons/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/assets/images/products/kubedb/icons/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/assets/images/products/kubedb/icons/favicon-16x16.png><link rel=manifest href=/assets/images/products/kubedb/icons/manifest.json><meta name=msapplication-TileColor content="#ffffff"><meta name=msapplication-TileImage content="/assets/images/products/kubedb/icons/ms-icon-144x144.png"><meta itemprop=name content="KubeDB by AppsCode"><meta itemprop=description content="KubeDB by AppsCode simplifies and automates routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair for various popular databases on private and public clouds"><meta itemprop=image content="https://kubedb.com/assets/images/products/kubedb/kubedb-1280x640.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@KubeDB"><meta name=twitter:title content="KubeDB by AppsCode"><meta name=twitter:creator content="@KubeDB"><meta name=twitter:description content="KubeDB by AppsCode simplifies and automates routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair for various popular databases on private and public clouds"><meta name=twitter:image:src content="https://kubedb.com/assets/images/products/kubedb/kubedb-1280x640.png"><meta property="og:url" content="https://kubedb.com"><meta property="og:title" content="KubeDB by AppsCode"><meta property="og:description" content="KubeDB by AppsCode simplifies and automates routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair for various popular databases on private and public clouds"><meta property="og:site_name" content="KubeDB by AppsCode"><meta property="og:image" content="https://kubedb.com/assets/images/products/kubedb/kubedb-1280x640.png"><meta property="og:type" content="article"><link rel=stylesheet href=/assets/css/font-awesome.min.css><link href=https://unpkg.com/aos@2.3.1/dist/aos.css rel=stylesheet><link rel=stylesheet href=/assets/css/bulma-carousel.min.css><link rel=stylesheet href=/assets/css/bulma-tooltip.min.css><link rel=stylesheet href=/assets/css/bulma.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/keen-slider@latest/keen-slider.min.css><link rel=stylesheet href=/assets/sass/main.min.5d2c0297a6ff960daed9d0bfe02ddc681d62b160aafc866ad48d2745f78048d9.css></head><body class=kubedb><header><div class=header-top><div class="container section"><nav class=navbar><div class=navbar-brand><a class=navbar-item href=https://appscode.com><img src=/assets/images/products/appscode/appscode.png alt=AppsCode></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=acNav1><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=acNav1 class="navbar-menu main-menu"><div class=navbar-end><div class=navbar-start><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Products</a><div class=ac-megamenu><div class=columns><div class="column is-6"><div class=columns><div class="column is-12 br-1"><a href=https://kubedb.com class="single-product-item is-kubedb"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/kubedb/kubedb-icon.png alt=KubeDB></div><h5>KubeDB</h5></div><div class=menu-body><p>Run production-grade Databases on Kubernetes</p></div></a><a href=https://stash.run class="single-product-item is-stash"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/stash/stash-icon.png alt=Stash></div><h5>Stash</h5></div><div class=menu-body><p>Backup your Kubernetes Stateful Applications</p></div></a><a href=https://kubevault.com class="single-product-item is-kubevault"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/kubevault/kubevault-icon.png alt=KubeVault></div><h5>KubeVault</h5></div><div class=menu-body><p>Tools for running HashiCorp Vault on Kubernetes</p></div></a></div></div></div><div class="column is-6"><div class=columns><div class="column is-12"><a href=https://byte.builders class="single-product-item byte-builder kd-orange"><div class=menu-header><p class=intro>Introducing....</p><h5>ByteBuilders</h5></div><div class=menu-body><p>Cloud reimagined for the age of Kubernetes</p></div><p class=learn-more-btn>Learn more
<span class=icon><i class="fa fa-long-arrow-right" aria-hidden=true></i></span></p></a><a href=https://kubeform.cloud class="single-product-item is-kubeform"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/kubeform/kubeform-icon.png alt=Kubeform></div><h5>Kubeform</h5></div><div class=menu-body><p>Provision cloud resources using Kubernetes CRDs & Terraform</p></div></a></div></div></div></div></div></div><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Open Source</a><div class=ac-megamenu><div class=columns><div class="column is-6"><div class=columns><div class="column is-12 br-1"><a href=https://voyagermesh.com class="single-product-item is-voyager"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/voyager/voyager-icon.png alt=Voyager></div><h5>Voyager</h5></div><div class=menu-body><p>Secure HAProxy Ingress Controller for
Kubernetes</p></div></a><a href=https://appscode.com/products/guard/ class="single-product-item is-guard"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/guard/guard-icon.png alt=Guard></div><h5>Guard</h5></div><div class=menu-body><p>Kubernetes Authentication WebHook Server</p></div></a><a href=https://appscode.com/products/kubed/ class="single-product-item is-kubed"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/kubed/kubed-icon.png alt=Kubed></div><h5>Kubed</h5></div><div class=menu-body><p>Kubernetes cluster manager daemon</p></div></a></div></div></div><div class="column is-6"><div class=columns><div class="column is-12"><a href=https://pharmer.cloud class="single-product-item is-pharmer"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/pharmer/pharmer-icon.png alt=Pharmer></div><h5>Pharmer</h5></div><div class=menu-body><p>Kubernetes Cluster Manager using Kubeadm & Cluster API</p></div></a><a href=https://appscode.com/products/swift/ class="single-product-item is-swift"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/swift/swift-icon.png alt=Swift></div><h5>Swift</h5></div><div class=menu-body><p>Ajax friendly Helm Tiller Proxy</p></div></a><a href=https://appscode.com/products/searchlight/ class="single-product-item is-searchlight"><div class=menu-header><div class=menu-logo><img src=/assets/images/products/searchlight/searchlight-icon.png alt=Searchlight></div><h5>Searchlight</h5></div><div class=menu-body><p>Alerts for Kubernetes</p></div></a></div></div></div></div></div></div><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Services</a><div class=ac-dropdown><a class=navbar-item href=https://appscode.com/consulting/>Consulting</a>
<a class=navbar-item href=https://appscode.com/training/>Training</a>
<a class=navbar-item href=https://appscode.com/support/>Support</a></div></div><a class=navbar-item href=https://blog.byte.builders>Blog</a>
<a class=navbar-item href=https://appscode.com/contact/>Contact Us</a></div><div class=navbar-item><div class="buttons main-menu-button-top"><a class="button is-small for-chat" href=https://slack.appscode.com><span><img src=/assets/images/icon/slack.png alt></span>Slack</a>
<a class="button is-small for-support" href=https://appscode.freshdesk.com><span><img src=/assets/images/icon/chat.png alt></span>Support Portal</a></div></div></div></div></nav></div></div><div class="header-bottom-area header-area kubedb-primary-bg customize-kubedb fixed-menu"><div class="container section"><nav class=navbar><div class=navbar-brand><a class=navbar-item href=https://kubedb.com><img src=/assets/images/products/kubedb/kubedb-white.png alt=KubeDB></a>
<a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=acNav><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><div id=acNav class="navbar-menu main-menu"><div class=navbar-end><div class=navbar-start><a href=/features/ class=navbar-item>Features</a>
<a href=/pricing/ class=navbar-item>Pricing</a><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Databases</a><div class=ac-dropdown><a class=navbar-item href=/docs/v2021.03.17/guides/elasticsearch/>Elasticsearch</a>
<a class=navbar-item href=/docs/v2021.03.17/guides/mariadb/>MariaDB</a>
<a class=navbar-item href=/docs/v2021.03.17/guides/memcached/>Memcached</a>
<a class=navbar-item href=/docs/v2021.03.17/guides/mongodb/>MongoDB</a>
<a class=navbar-item href=/docs/v2021.03.17/guides/mysql/>MySQL</a>
<a class=navbar-item href=/docs/v2021.03.17/guides/percona-xtradb/>Percona XtraDB</a>
<a class=navbar-item href=/docs/v2021.03.17/guides/pgbouncer/>PgBouncer</a>
<a class=navbar-item href=/docs/v2021.03.17/guides/postgres/>PostgreSQL</a>
<a class=navbar-item href=/docs/v2021.03.17/guides/proxysql/>ProxySQL</a>
<a class=navbar-item href=/docs/v2021.03.17/guides/redis/>Redis</a></div></div><a href=/docs/v2021.03.17/welcome/ class=navbar-item>Documentation</a><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Community</a><div class=ac-dropdown><a href=https://github.com/kubedb class=navbar-item>GitHub</a>
<a href=https://twitter.com/KubeDB class=navbar-item>Twitter</a>
<a href=http://slack.kubernetes.io/ class=navbar-item>Slack</a></div></div></div><div class=navbar-item><div class="buttons main-menu-button"><img style=height:24px alt="GitHub Stars" src="https://img.shields.io/badge/dynamic/json?style=flat&labelColor=1B3D4B&color=06A64F&logoColor=white&logo=github&label=stars&query=%24.stars&url=https://github-stars.appscode.workers.dev/user/kubedb">
&nbsp;&nbsp;&nbsp;
<img style=height:24px alt="GitHub Forks" src="https://img.shields.io/badge/dynamic/json?style=flat&labelColor=1B3D4B&color=06A64F&logoColor=white&logo=github&label=forks&query=%24.forks&url=https://github-stars.appscode.workers.dev/user/kubedb">
&nbsp;&nbsp;&nbsp;
<img style=height:24px alt="Docker Pulls" src="https://img.shields.io/docker/pulls/kubedb/operator?style=flat&labelColor=1B3D4B&color=06A64F&logoColor=white&logo=docker&label=pulls"></div></div></div></div></nav></div></div><div class=documentation-menu><div class="container section"><div class=is-centered><div class="is-half has-text-centered-desktop"><div class=responsive-menu><a role=button class="navbar-burger burger" aria-label=menu aria-expanded=false data-target=acNav3><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a></div><nav class=documentation-navbar><div id=acNav3 class="navbar-menu nav-menu main-menu"><div class=navbar-centered><div class=navbar-start><a href=/docs/v2021.03.17/ class=navbar-item>Welcome</a>
<a href=/docs/v2021.03.17/overview/ class=navbar-item>Overview</a>
<a href=/docs/v2021.03.17/setup/ class=navbar-item>Setup</a><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Guides</a><div class=ac-dropdown><a href=/docs/v2021.03.17/guides/elasticsearch/ class=navbar-item>Elasticsearch</a>
<a href=/docs/v2021.03.17/guides/mariadb/ class=navbar-item>MariaDB</a>
<a href=/docs/v2021.03.17/guides/memcached/ class=navbar-item>Memcached</a>
<a href=/docs/v2021.03.17/guides/mongodb/ class=navbar-item>MongoDB</a>
<a href=/docs/v2021.03.17/guides/mysql/ class=navbar-item>MySQL</a>
<a href=/docs/v2021.03.17/guides/percona-xtradb/ class=navbar-item>Percona XtraDB</a>
<a href=/docs/v2021.03.17/guides/pgbouncer/ class=navbar-item>PgBouncer</a>
<a href=/docs/v2021.03.17/guides/postgres/ class=navbar-item>PostgreSQL</a>
<a href=/docs/v2021.03.17/guides/proxysql/ class=navbar-item>ProxySQL</a>
<a href=/docs/v2021.03.17/guides/redis/ class=navbar-item>Redis</a></div></div><div class="navbar-item has-dropdown ac-is-hoverable"><a class=navbar-link>Reference</a><div class=ac-dropdown><a href=/docs/v2021.03.17/reference/operator/ class=navbar-item>KubeDB Operator</a>
<a href=/docs/v2021.03.17/reference/cli/ class=navbar-item>KubeDB CLI</a></div></div></div></div></div></nav></div></div></div></div></header><div class=documentation-area><div class="container section"><div class=columns><div class="column is-3"><div class=kd-left-sidebar><div class=trial-button><a href=/docs/v2021.03.17/setup/ class="button is-fullwidth">Try Now for FREE!</a></div><div class=kd-version><div class=dropdown><div class=dropdown-trigger><button class="button is-fullwidth" aria-haspopup=true aria-controls=dropdown-menu3>
<span><strong class=icon><i class="fa fa-cog" aria-hidden=true></i></strong>v2021.03.17</span>
<span class=new-item>Latest</span>
<span class="icon is-small"><i class="fa fa-angle-down" aria-hidden=true></i></span></button></div><div class=dropdown-menu id=dropdown-menu3 role=menu><div class=dropdown-content><a href=https://github.com/kubedb/docs/tree/master/docs target=_blank class=dropdown-item>master</a>
<a href=/docs/v2021.03.17/ class=dropdown-item>v2021.03.17<div class=tag>Latest</div></a><a href=/docs/v2021.01.26/ class=dropdown-item>v2021.01.26</a>
<a href=/docs/v2021.01.15/ class=dropdown-item>v2021.01.15</a>
<a href=/docs/v2021.01.02-rc.0/ class=dropdown-item>v2021.01.02-rc.0</a>
<a href=/docs/v2020.12.10/ class=dropdown-item>v2020.12.10</a>
<a href=/docs/v2020.11.12/ class=dropdown-item>v2020.11.12</a>
<a href=/docs/v2020.11.11/ class=dropdown-item>v2020.11.11</a>
<a href=/docs/v2020.11.08/ class=dropdown-item>v2020.11.08</a>
<a href=/docs/v2020.10.28/ class=dropdown-item>v2020.10.28</a>
<a href=/docs/v0.13.0-rc.0/ class=dropdown-item>v0.13.0-rc.0</a>
<a href=/docs/0.12.0/ class=dropdown-item>0.12.0</a></div></div></div></div><div class=kd-sidebar-menu><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-1>
<label for=0add62db2a8609d797e7d1704aa7cc34-1><a href=/docs/v2021.03.17/guides/>Elasticsearch</a></label></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-2>
<label for=0add62db2a8609d797e7d1704aa7cc34-2><a href=/docs/v2021.03.17/guides/elasticsearch/>Elasticsearch</a></label></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-3>
<label for=0add62db2a8609d797e7d1704aa7cc34-3><a>Quickstart</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/quickstart/overview/>Overview</a></li></ul></div></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-4>
<label for=0add62db2a8609d797e7d1704aa7cc34-4><a>Concepts</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/concepts/elasticsearch/>Elasticsearch</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/concepts/elasticsearch-ops-request/>ElasticsearchOpsRequest</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/concepts/catalog/>ElasticsearchVersion</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/concepts/appbinding/>AppBinding</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/concepts/autoscaler/>ElasticsearchAutoscaler</a></li></ul></div></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-5>
<label for=0add62db2a8609d797e7d1704aa7cc34-5><a>Clustering</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/clustering/combined-cluster/>Combined Cluster</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/clustering/topology-cluster/>Topology Cluster</a></li></ul></div></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-6>
<label for=0add62db2a8609d797e7d1704aa7cc34-6><a>Custom Configuration</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/configuration/overview/>Overview</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/configuration/combined-cluster/>Combined Cluster</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/configuration/topology-cluster/>Topology Cluster</a></li></ul></div></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-7>
<label for=0add62db2a8609d797e7d1704aa7cc34-7><a>Custom RBAC</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/custom-rbac/using-custom-rbac/>Custom RBAC</a></li></ul></div></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-8>
<label for=0add62db2a8609d797e7d1704aa7cc34-8><a>Private Registry</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/private-registry/using-private-registry/>Quickstart</a></li></ul></div></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-9 checked>
<label for=0add62db2a8609d797e7d1704aa7cc34-9><a>Backup & Restore</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/backup/overview/>Overview</a></li><li class=is-active><a href=/docs/v2021.03.17/guides/elasticsearch/backup/kubedb/>Scheduled Backup</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/backup/auto-backup/>Auto-Backup</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/backup/customization/>Customizing Backup & Restore Process</a></li></ul></div></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-10>
<label for=0add62db2a8609d797e7d1704aa7cc34-10><a>Autoscaling</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-11>
<label for=0add62db2a8609d797e7d1704aa7cc34-11><a>Compute Autoscaling</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/autoscaler/compute/overview/>Overview</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/autoscaler/compute/combined/>Combined</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/autoscaler/compute/topology/>Topology Cluster</a></li></ul></div></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-12>
<label for=0add62db2a8609d797e7d1704aa7cc34-12><a>Storage Autoscaling</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/autoscaler/storage/overview/>Overview</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/autoscaler/storage/combined/>Combined Cluster</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/autoscaler/storage/topology/>Topology Cluster</a></li></ul></div></div></ul></div></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-13>
<label for=0add62db2a8609d797e7d1704aa7cc34-13><a>Monitoring</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/monitoring/overview/>Overview</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/monitoring/using-prometheus-operator/>Prometheus Operator</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/monitoring/using-builtin-prometheus/>Builtin Prometheus</a></li></ul></div></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-14>
<label for=0add62db2a8609d797e7d1704aa7cc34-14><a>X-Pack</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/x-pack/configuration/>X-Pack Configuration</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/x-pack/use-tls/>Use TLS</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/x-pack/issue-certificate/>Issue Certificate</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/x-pack/disable-xpack/>Disable X-Pack</a></li></ul></div></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-15>
<label for=0add62db2a8609d797e7d1704aa7cc34-15><a>Search Guard</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/search-guard/overview/>Overview</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/search-guard/configuration/>Configuration</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/search-guard/use-tls/>Use TLS</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/search-guard/issue-certificate/>Issue Certificate</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/search-guard/disable-searchguard/>Disable Search Guard</a></li><li><a href=/docs/v2021.03.17/guides/elasticsearch/search-guard/x-pack-monitoring/>Monitoring</a></li></ul></div></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-16>
<label for=0add62db2a8609d797e7d1704aa7cc34-16><a>Kibana</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/kibana/connect-kibana/>Use Kibana</a></li></ul></div></div><div class=item><input type=checkbox id=0add62db2a8609d797e7d1704aa7cc34-17>
<label for=0add62db2a8609d797e7d1704aa7cc34-17><a>CLI</a> <span><i class="fa fa-angle-right" aria-hidden=true></i></span></label><div class=item><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/cli/cli/>Quickstart</a></li></ul></div></div></div></div></div><div class="column is-7"><div class=full-info><h1 id=backup-and-restore-elasticsearch-database-deployed-with-kubedb>Backup and restore Elasticsearch database deployed with KubeDB</h1><p>Stash 0.9.0+ supports backup and restoration of Elasticsearch clusters. This guide will show you how you can backup and restore your KubeDB deployed Elasticsearch database using Stash.</p><h2 id=before-you-begin>Before You Begin</h2><ul><li>At first, you need to have a Kubernetes cluster, and the <code>kubectl</code> command-line tool must be configured to communicate with your cluster.</li><li>Install KubeDB in your cluster following the steps <a href=/docs/v2021.03.17/setup/README>here</a>.</li><li>Install Stash Enterprise in your cluster following the steps <a href=https://stash.run/docs/latest/setup/install/enterprise/>here</a>.</li><li>If you are not familiar with how Stash backup and restore Elasticsearch databases, please check the following guide <a href=/docs/v2021.03.17/guides/elasticsearch/backup/overview/>here</a>.</li></ul><p>You have to be familiar with following custom resources:</p><ul><li><a href=/docs/v2021.03.17/guides/elasticsearch/concepts/appbinding/>AppBinding</a></li><li><a href=https://stash.run/docs/latest/concepts/crds/function/>Function</a></li><li><a href=https://stash.run/docs/latest/concepts/crds/task/>Task</a></li><li><a href=https://stash.run/docs/latest/concepts/crds/backupconfiguration/>BackupConfiguration</a></li><li><a href=https://stash.run/docs/latest/concepts/crds/backupsession/>BackupSession</a></li><li><a href=https://stash.run/docs/latest/concepts/crds/restoresession/>RestoreSession</a></li></ul><p>To keep things isolated, we are going to use a separate namespace called <code>demo</code> throughout this tutorial. Create <code>demo</code> namespace if you haven&rsquo;t created it yet.</p><pre><code class=language-console data-lang=console>$ kubectl create ns demo
namespace/demo created
</code></pre><h2 id=prepare-elasticsearch>Prepare Elasticsearch</h2><p>In this section, we are going to deploy an Elasticsearch database using KubeDB. Then, we are going to insert some sample data into it.</p><h3 id=deploy-elasticsearch>Deploy Elasticsearch</h3><p>At first, let&rsquo;s deploy a sample Elasticsearch database. Below is the YAML of a sample Elasticsearch crd that we are going to create for this tutorial:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>kubedb.com/v1alpha2</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Elasticsearch</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>sample-es</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>demo</span>
<span style=color:#f92672>spec</span>:
  <span style=color:#f92672>version</span>: <span style=color:#ae81ff>xpack-7.9.1-v1</span>
  <span style=color:#f92672>storageType</span>: <span style=color:#ae81ff>Durable</span>
  <span style=color:#f92672>topology</span>:
    <span style=color:#f92672>master</span>:
      <span style=color:#f92672>suffix</span>: <span style=color:#ae81ff>master</span>
      <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
      <span style=color:#f92672>storage</span>:
        <span style=color:#f92672>storageClassName</span>: <span style=color:#e6db74>&#34;standard&#34;</span>
        <span style=color:#f92672>accessModes</span>:
        - <span style=color:#ae81ff>ReadWriteOnce</span>
        <span style=color:#f92672>resources</span>:
          <span style=color:#f92672>requests</span>:
            <span style=color:#f92672>storage</span>: <span style=color:#ae81ff>1Gi</span>
    <span style=color:#f92672>data</span>:
      <span style=color:#f92672>suffix</span>: <span style=color:#ae81ff>data</span>
      <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>2</span>
      <span style=color:#f92672>storage</span>:
        <span style=color:#f92672>storageClassName</span>: <span style=color:#e6db74>&#34;standard&#34;</span>
        <span style=color:#f92672>accessModes</span>:
        - <span style=color:#ae81ff>ReadWriteOnce</span>
        <span style=color:#f92672>resources</span>:
          <span style=color:#f92672>requests</span>:
            <span style=color:#f92672>storage</span>: <span style=color:#ae81ff>1Gi</span>
    <span style=color:#f92672>ingest</span>:
      <span style=color:#f92672>suffix</span>: <span style=color:#ae81ff>client</span>
      <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>2</span>
      <span style=color:#f92672>storage</span>:
        <span style=color:#f92672>storageClassName</span>: <span style=color:#e6db74>&#34;standard&#34;</span>
        <span style=color:#f92672>accessModes</span>:
        - <span style=color:#ae81ff>ReadWriteOnce</span>
        <span style=color:#f92672>resources</span>:
          <span style=color:#f92672>requests</span>:
            <span style=color:#f92672>storage</span>: <span style=color:#ae81ff>1Gi</span>
</code></pre></div><p>Let&rsquo;s create the above <code>Elasticsearch</code> object,</p><pre><code class=language-console data-lang=console>$ kubectl apply -f https://github.com/kubedb/docs/raw/v2021.03.17/docs/guides/elasticsearch/backup/kubedb/examples/elasticsearch/sample_es.yaml
elasticsearch.kubedb.com/sample-es created
</code></pre><p>KubeDB will create the necessary resources to deploy the Elasticsearch database according to the above specification. Let&rsquo;s wait until the database to be ready to use,</p><pre><code class=language-console data-lang=console>❯ kubectl get elasticsearch -n demo -w
NAME        VERSION          STATUS         AGE
sample-es   xpack-7.9.1-v1   Provisioning   89s
sample-es   xpack-7.9.1-v1   Ready          5m26s
</code></pre><p>The database is in <code>Ready</code> state. It means the database is ready to accept connections.</p><h3 id=insert-sample-data>Insert Sample Data</h3><p>In this section, we are going to create few indexes in the deployed Elasticsearch. At first, we are going to port-forward the respective Service so that we can connect with the database from our local machine. Then, we are going to insert some data into the Elasticsearch.</p><h4 id=port-forward-the-service>Port-forward the Service</h4><p>KubeDB will create few Services to connect with the database. Let&rsquo;s see the Services created by KubeDB for our Elasticsearch,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get service -n demo
NAME               TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span style=color:#f92672>(</span>S<span style=color:#f92672>)</span>    AGE
sample-es          ClusterIP   10.108.129.195   &lt;none&gt;        9200/TCP   10m
sample-es-master   ClusterIP   None             &lt;none&gt;        9300/TCP   10m
sample-es-pods     ClusterIP   None             &lt;none&gt;        9200/TCP   10m
</code></pre></div><p>Here, we are going to use the <code>sample-es</code> Service to connect with the database. Now, let&rsquo;s port-forward the <code>sample-es</code> Service. Run the following command into a separate terminal.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl port-forward -n demo service/sample-es <span style=color:#ae81ff>9200</span>
Forwarding from 127.0.0.1:9200 -&gt; <span style=color:#ae81ff>9200</span>
Forwarding from <span style=color:#f92672>[</span>::1<span style=color:#f92672>]</span>:9200 -&gt; <span style=color:#ae81ff>9200</span>
</code></pre></div><h4 id=export-the-credentials>Export the Credentials</h4><p>KubeDB will create some Secrets for the database. Let&rsquo;s check which Secrets have been created by KubeDB for our <code>sample-es</code> Elasticsearch.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get secret -n demo | grep sample-es
sample-es-ca-cert          kubernetes.io/tls                     <span style=color:#ae81ff>2</span>      21m
sample-es-config           Opaque                                <span style=color:#ae81ff>1</span>      21m
sample-es-elastic-cred     kubernetes.io/basic-auth              <span style=color:#ae81ff>2</span>      21m
sample-es-token-ctzn5      kubernetes.io/service-account-token   <span style=color:#ae81ff>3</span>      21m
sample-es-transport-cert   kubernetes.io/tls                     <span style=color:#ae81ff>3</span>      21m
</code></pre></div><p>Here, <code>sample-es-elastic-cred</code> contains the credentials require to connect with the database. Let&rsquo;s export the credentials as environment variable to our current shell so that we can easily environment variables to connect with the database.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ export USER<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>kubectl get secrets -n demo sample-es-elastic-cred -o jsonpath<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{.data.\username}&#39;</span> | base64 -d<span style=color:#66d9ef>)</span>
❯ export PASSWORD<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>kubectl get secrets -n demo sample-es-elastic-cred -o jsonpath<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{.data.\password}&#39;</span> | base64 -d<span style=color:#66d9ef>)</span>
</code></pre></div><h4 id=insert-data>Insert data</h4><p>Now, let&rsquo;s create an index called <code>products</code> and insert some data into it.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Elasticsearch will automatically create the index if it does not exist already.</span>
❯ curl -XPOST --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/products/_doc?pretty&#34;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d<span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{
</span><span style=color:#e6db74>    &#34;name&#34;: &#34;KubeDB&#34;,
</span><span style=color:#e6db74>    &#34;vendor&#34;: &#34;AppsCode Inc.&#34;,
</span><span style=color:#e6db74>    &#34;description&#34;: &#34;Database Operator for Kubernetes&#34;
</span><span style=color:#e6db74>}
</span><span style=color:#e6db74>&#39;</span>

<span style=color:#75715e># Let&#39;s insert another data into the &#34;products&#34; index.</span>
❯ curl -XPOST --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/products/_doc?pretty&#34;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d<span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{
</span><span style=color:#e6db74>    &#34;name&#34;: &#34;Stash&#34;,
</span><span style=color:#e6db74>    &#34;vendor&#34;: &#34;AppsCode Inc.&#34;,
</span><span style=color:#e6db74>    &#34;description&#34;: &#34;Backup tool for Kubernetes workloads&#34;
</span><span style=color:#e6db74>}
</span><span style=color:#e6db74>&#39;</span>
</code></pre></div><p>Let&rsquo;s create another index called <code>companies</code> and insert some data into it.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ curl -XPOST --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/companies/_doc?pretty&#34;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> -d<span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>{
</span><span style=color:#e6db74>    &#34;name&#34;: &#34;AppsCode Inc.&#34;,
</span><span style=color:#e6db74>    &#34;mission&#34;: &#34;Accelerate the transition to Containers by building a Kubernetes-native Data Platform&#34;,
</span><span style=color:#e6db74>    &#34;products&#34;: [&#34;KubeDB&#34;, &#34;Stash&#34;, &#34;KubeVault&#34;, &#34;Kubeform&#34;, &#34;ByteBuilders&#34;]
</span><span style=color:#e6db74>}
</span><span style=color:#e6db74>&#39;</span>
</code></pre></div><p>Now, let&rsquo;s verify that the indexes have been created successfully.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ curl -XGET --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/_cat/indices?v&amp;s=index&amp;pretty&#34;</span>
health status index     uuid                   pri rep docs.count docs.deleted store.size pri.store.size
green  open   companies qs52L4xrShay14NPUExDNw   <span style=color:#ae81ff>1</span>   <span style=color:#ae81ff>1</span>          <span style=color:#ae81ff>1</span>            <span style=color:#ae81ff>0</span>     11.5kb          5.7kb
green  open   products  6aCd7y_kQf26sYG3QdY0ow   <span style=color:#ae81ff>1</span>   <span style=color:#ae81ff>1</span>          <span style=color:#ae81ff>2</span>            <span style=color:#ae81ff>0</span>     20.7kb         10.3kb
</code></pre></div><p>Also, let&rsquo;s verify the data in the indexes:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Verify the data in the &#34;product&#34; index.</span>
❯ curl -XGET --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/products/_search?pretty&#34;</span>
<span style=color:#f92672>{</span>
  <span style=color:#e6db74>&#34;took&#34;</span> : 354,
  <span style=color:#e6db74>&#34;timed_out&#34;</span> : false,
  <span style=color:#e6db74>&#34;_shards&#34;</span> : <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;total&#34;</span> : 1,
    <span style=color:#e6db74>&#34;successful&#34;</span> : 1,
    <span style=color:#e6db74>&#34;skipped&#34;</span> : 0,
    <span style=color:#e6db74>&#34;failed&#34;</span> : <span style=color:#ae81ff>0</span>
  <span style=color:#f92672>}</span>,
  <span style=color:#e6db74>&#34;hits&#34;</span> : <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;total&#34;</span> : <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;value&#34;</span> : 2,
      <span style=color:#e6db74>&#34;relation&#34;</span> : <span style=color:#e6db74>&#34;eq&#34;</span>
    <span style=color:#f92672>}</span>,
    <span style=color:#e6db74>&#34;max_score&#34;</span> : 1.0,
    <span style=color:#e6db74>&#34;hits&#34;</span> : <span style=color:#f92672>[</span>
      <span style=color:#f92672>{</span>
        <span style=color:#e6db74>&#34;_index&#34;</span> : <span style=color:#e6db74>&#34;products&#34;</span>,
        <span style=color:#e6db74>&#34;_type&#34;</span> : <span style=color:#e6db74>&#34;_doc&#34;</span>,
        <span style=color:#e6db74>&#34;_id&#34;</span> : <span style=color:#e6db74>&#34;3GyXa3cB55U52E6TvL8f&#34;</span>,
        <span style=color:#e6db74>&#34;_score&#34;</span> : 1.0,
        <span style=color:#e6db74>&#34;_source&#34;</span> : <span style=color:#f92672>{</span>
          <span style=color:#e6db74>&#34;name&#34;</span> : <span style=color:#e6db74>&#34;KubeDB&#34;</span>,
          <span style=color:#e6db74>&#34;vendor&#34;</span> : <span style=color:#e6db74>&#34;AppsCode Inc.&#34;</span>,
          <span style=color:#e6db74>&#34;description&#34;</span> : <span style=color:#e6db74>&#34;Database Operator for Kubernetes&#34;</span>
        <span style=color:#f92672>}</span>
      <span style=color:#f92672>}</span>,
      <span style=color:#f92672>{</span>
        <span style=color:#e6db74>&#34;_index&#34;</span> : <span style=color:#e6db74>&#34;products&#34;</span>,
        <span style=color:#e6db74>&#34;_type&#34;</span> : <span style=color:#e6db74>&#34;_doc&#34;</span>,
        <span style=color:#e6db74>&#34;_id&#34;</span> : <span style=color:#e6db74>&#34;3WyYa3cB55U52E6Tc7_G&#34;</span>,
        <span style=color:#e6db74>&#34;_score&#34;</span> : 1.0,
        <span style=color:#e6db74>&#34;_source&#34;</span> : <span style=color:#f92672>{</span>
          <span style=color:#e6db74>&#34;name&#34;</span> : <span style=color:#e6db74>&#34;Stash&#34;</span>,
          <span style=color:#e6db74>&#34;vendor&#34;</span> : <span style=color:#e6db74>&#34;AppsCode Inc.&#34;</span>,
          <span style=color:#e6db74>&#34;description&#34;</span> : <span style=color:#e6db74>&#34;Backup tool for Kubernetes workloads&#34;</span>
        <span style=color:#f92672>}</span>
      <span style=color:#f92672>}</span>
    <span style=color:#f92672>]</span>
  <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>

<span style=color:#75715e># Verify data in the &#34;companies&#34; index.</span>
❯ curl -XGET --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/companies/_search?pretty&#34;</span>
<span style=color:#f92672>{</span>
  <span style=color:#e6db74>&#34;took&#34;</span> : 172,
  <span style=color:#e6db74>&#34;timed_out&#34;</span> : false,
  <span style=color:#e6db74>&#34;_shards&#34;</span> : <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;total&#34;</span> : 1,
    <span style=color:#e6db74>&#34;successful&#34;</span> : 1,
    <span style=color:#e6db74>&#34;skipped&#34;</span> : 0,
    <span style=color:#e6db74>&#34;failed&#34;</span> : <span style=color:#ae81ff>0</span>
  <span style=color:#f92672>}</span>,
  <span style=color:#e6db74>&#34;hits&#34;</span> : <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;total&#34;</span> : <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;value&#34;</span> : 1,
      <span style=color:#e6db74>&#34;relation&#34;</span> : <span style=color:#e6db74>&#34;eq&#34;</span>
    <span style=color:#f92672>}</span>,
    <span style=color:#e6db74>&#34;max_score&#34;</span> : 1.0,
    <span style=color:#e6db74>&#34;hits&#34;</span> : <span style=color:#f92672>[</span>
      <span style=color:#f92672>{</span>
        <span style=color:#e6db74>&#34;_index&#34;</span> : <span style=color:#e6db74>&#34;companies&#34;</span>,
        <span style=color:#e6db74>&#34;_type&#34;</span> : <span style=color:#e6db74>&#34;_doc&#34;</span>,
        <span style=color:#e6db74>&#34;_id&#34;</span> : <span style=color:#e6db74>&#34;3myya3cB55U52E6TE78a&#34;</span>,
        <span style=color:#e6db74>&#34;_score&#34;</span> : 1.0,
        <span style=color:#e6db74>&#34;_source&#34;</span> : <span style=color:#f92672>{</span>
          <span style=color:#e6db74>&#34;name&#34;</span> : <span style=color:#e6db74>&#34;AppsCode Inc.&#34;</span>,
          <span style=color:#e6db74>&#34;mission&#34;</span> : <span style=color:#e6db74>&#34;Accelerate the transition to Containers by building a Kubernetes-native Data Platform&#34;</span>,
          <span style=color:#e6db74>&#34;products&#34;</span> : <span style=color:#f92672>[</span>
            <span style=color:#e6db74>&#34;KubeDB&#34;</span>,
            <span style=color:#e6db74>&#34;Stash&#34;</span>,
            <span style=color:#e6db74>&#34;KubeVault&#34;</span>,
            <span style=color:#e6db74>&#34;Kubeform&#34;</span>,
            <span style=color:#e6db74>&#34;ByteBuilders&#34;</span>
          <span style=color:#f92672>]</span>
        <span style=color:#f92672>}</span>
      <span style=color:#f92672>}</span>
    <span style=color:#f92672>]</span>
  <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>We now have sample data in our database. In the next section, we are going to prepare the necessary resources to backup these sample data.</p><h2 id=prepare-for-backup>Prepare for Backup</h2><p>In this section, we are going to prepare our cluster for backup.</p><h3 id=verify-appbinding>Verify AppBinding</h3><p>KubeDB will create an <code>AppBinding</code> object with the same name as the database object which contains the necessary information requires to connect with the database.</p><p>Let&rsquo;s verify that the <code>AppBinding</code> object has been created for our <code>sample-es</code> Elasticsearch,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get appbindings.appcatalog.appscode.com -n demo sample-es
NAME        TYPE                       VERSION   AGE
sample-es   kubedb.com/elasticsearch   7.9.1     2d
</code></pre></div><p>Now, if you check the YAML of the <code>AppBinding</code>, you will see that it contains the service and secret information that are necessary to connect with the database.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#ae81ff>❯ kubectl get appbindings.appcatalog.appscode.com -n demo sample-es -o yaml</span>
<span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>appcatalog.appscode.com/v1alpha1</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>AppBinding</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>sample-es</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>demo</span>
  <span style=color:#ae81ff>...</span>
<span style=color:#f92672>spec</span>:
  <span style=color:#f92672>clientConfig</span>:
    <span style=color:#f92672>service</span>:
      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>sample-es</span>
      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>9200</span>
      <span style=color:#f92672>scheme</span>: <span style=color:#ae81ff>http</span>
  <span style=color:#f92672>secret</span>:
    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>sample-es-elastic-cred</span>
  <span style=color:#f92672>parameters</span>:
    <span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>appcatalog.appscode.com/v1alpha1</span>
    <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>StashAddon</span>
    <span style=color:#f92672>stash</span>:
      <span style=color:#f92672>addon</span>:
        <span style=color:#f92672>backupTask</span>:
          <span style=color:#f92672>name</span>: <span style=color:#ae81ff>elasticsearch-backup-7.3.2</span>
        <span style=color:#f92672>restoreTask</span>:
          <span style=color:#f92672>name</span>: <span style=color:#ae81ff>elasticsearch-restore-7.3.2</span>
  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>kubedb.com/elasticsearch</span>
  <span style=color:#f92672>version</span>: <span style=color:#ae81ff>7.9.1</span>
</code></pre></div><p>Here,</p><ul><li><code>spec.parameters.stash</code> section specifies the Stash Addon that will be used to backup and restore this Elasticsearch.</li></ul><h3 id=verify-stash-elasticsearch-addons-installed>Verify Stash Elasticsearch Addons Installed</h3><p>When you install the Stash Enterprise edition, it automatically installs all the official database addons. Verify that it has installed the Elasticsearch addons using the following command.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get tasks.stash.appscode.com | grep elasticsearch
elasticsearch-backup-5.6.4    3d2h
elasticsearch-backup-6.2.4    3d2h
elasticsearch-backup-6.3.0    3d2h
elasticsearch-backup-6.4.0    3d2h
elasticsearch-backup-6.5.3    3d2h
elasticsearch-backup-6.8.0    3d2h
elasticsearch-backup-7.2.0    3d2h
elasticsearch-backup-7.3.2    3d2h
elasticsearch-restore-5.6.4   3d2h
elasticsearch-restore-6.2.4   3d2h
elasticsearch-restore-6.3.0   3d2h
elasticsearch-restore-6.4.0   3d2h
elasticsearch-restore-6.5.3   3d2h
elasticsearch-restore-6.8.0   3d2h
elasticsearch-restore-7.2.0   3d2h
elasticsearch-restore-7.3.2   3d2h
</code></pre></div><h3 id=prepare-backend>Prepare Backend</h3><p>We are going to store our backed up data into a GCS bucket. So, we need to create a <code>Secret</code> with GCS credentials and a <code>Repository</code> object with the bucket information. If you want to use a different backend, please read the respective backend configuration doc from <a href=https://stash.run/docs/latest/guides/latest/backends/overview/>here</a>.</p><h4 id=create-storage-secret>Create Storage Secret</h4><p>At first, let&rsquo;s create a <code>Secret</code> called <code>gcs-secret</code> with access credentials to our desired GCS bucket,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ echo -n <span style=color:#e6db74>&#39;changeit&#39;</span> &gt; RESTIC_PASSWORD
$ echo -n <span style=color:#e6db74>&#39;&lt;your-project-id&gt;&#39;</span> &gt; GOOGLE_PROJECT_ID
$ cat downloaded-sa-json.key &gt; GOOGLE_SERVICE_ACCOUNT_JSON_KEY
$ kubectl create secret generic -n demo gcs-secret <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --from-file<span style=color:#f92672>=</span>./RESTIC_PASSWORD <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --from-file<span style=color:#f92672>=</span>./GOOGLE_PROJECT_ID <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>    --from-file<span style=color:#f92672>=</span>./GOOGLE_SERVICE_ACCOUNT_JSON_KEY
secret/gcs-secret created
</code></pre></div><h4 id=create-repository>Create Repository</h4><p>Now, crete a <code>Repository</code> object with the information of your desired bucket. Below is the YAML of <code>Repository</code> object we are going to create,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>stash.appscode.com/v1alpha1</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Repository</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>gcs-repo</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>demo</span>
<span style=color:#f92672>spec</span>:
  <span style=color:#f92672>backend</span>:
    <span style=color:#f92672>gcs</span>:
      <span style=color:#f92672>bucket</span>: <span style=color:#ae81ff>stash-testing</span>
      <span style=color:#f92672>prefix</span>: <span style=color:#ae81ff>/demo/sample-es</span>
    <span style=color:#f92672>storageSecretName</span>: <span style=color:#ae81ff>gcs-secret</span>
</code></pre></div><p>Let&rsquo;s create the <code>Repository</code> we have shown above,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kubectl create -f https://github.com/kubedb/docs/raw/v2021.03.17/docs/guides/mariadb/backup/kubedb/examples/backup/repository.yaml
repository.stash.appscode.com/gcs-repo created
</code></pre></div><p>Now, we are ready to backup our database into our desired backend.</p><h2 id=backup>Backup</h2><p>To schedule a backup, we have to create a <code>BackupConfiguration</code> object targeting the respective <code>AppBinding</code> of our desired database. Then, Stash will create a CronJob to periodically trigger a backup of the database.</p><h3 id=create-backupconfiguration>Create BackupConfiguration</h3><p>Below is the YAML for <code>BackupConfiguration</code> object we care going to use to backup the <code>sample-es</code> database we have deployed earlier,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>stash.appscode.com/v1beta1</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>BackupConfiguration</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>sample-es-backup</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>demo</span>
<span style=color:#f92672>spec</span>:
  <span style=color:#f92672>schedule</span>: <span style=color:#e6db74>&#34;*/5 * * * *&#34;</span>
  <span style=color:#f92672>repository</span>:
    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>gcs-repo</span>
  <span style=color:#f92672>target</span>:
    <span style=color:#f92672>ref</span>:
      <span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>appcatalog.appscode.com/v1alpha1</span>
      <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>AppBinding</span>
      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>sample-es</span>
  <span style=color:#f92672>interimVolumeTemplate</span>:
    <span style=color:#f92672>metadata</span>:
      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>sample-es-backup-tmp-storage</span>
    <span style=color:#f92672>spec</span>:
      <span style=color:#f92672>accessModes</span>: [ <span style=color:#e6db74>&#34;ReadWriteOnce&#34;</span> ]
      <span style=color:#f92672>storageClassName</span>: <span style=color:#e6db74>&#34;standard&#34;</span>
      <span style=color:#f92672>resources</span>:
        <span style=color:#f92672>requests</span>:
          <span style=color:#f92672>storage</span>: <span style=color:#ae81ff>1Gi</span>
  <span style=color:#f92672>retentionPolicy</span>:
    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>keep-last-5</span>
    <span style=color:#f92672>keepLast</span>: <span style=color:#ae81ff>5</span>
    <span style=color:#f92672>prune</span>: <span style=color:#66d9ef>true</span>
</code></pre></div><p>Here,</p><ul><li><code>.spec.schedule</code> specifies that we want to backup the database every 5th minutes.</li><li><code>.spec.target.ref</code> refers to the <code>AppBinding</code> object that holds the connection information of our targeted database.</li><li><code>spec.interimVolumeTemplate</code> specifies a PVC template that will be used by Stash to hold the dumped data temporarily before uploading it into the cloud bucket.</li></ul><p>Let&rsquo;s create the <code>BackupConfiguration</code> object we have shown above,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ kubectl create -f https://github.com/kubedb/docs/raw/v2021.03.17/docs/guides/elasticsearch/backup/kubedb/examples/backup/backupconfiguration.yaml
backupconfiguration.stash.appscode.com/sample-es-backup created
</code></pre></div><h3 id=verify-cronjob>Verify CronJob</h3><p>If everything goes well, Stash will create a CronJob with the schedule specified in the <code>spec.schedule</code> field of <code>BackupConfiguration</code> object.</p><p>Verify that the CronJob has been created using the following command,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get cronjob -n demo
NAME                            SCHEDULE      SUSPEND   ACTIVE   LAST SCHEDULE   AGE
stash-backup-sample-es-backup   */5 * * * *   False     <span style=color:#ae81ff>0</span>        &lt;none&gt;          9s
</code></pre></div><h3 id=wait-for-backupsession>Wait for BackupSession</h3><p>The <code>stash-backup-sample-es-backup</code> CronJob will trigger a backup on each scheduled slot by creating a <code>BackupSession</code> object.</p><p>Now, wait for a schedule to appear. Run the following command to watch for a <code>BackupSession</code> object,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get backupsessions.stash.appscode.com -n demo -w
NAME                          INVOKER-TYPE          INVOKER-NAME       PHASE       AGE
sample-es-backup-1612440003   BackupConfiguration   sample-es-backup               0s
sample-es-backup-1612440003   BackupConfiguration   sample-es-backup   Running     0s
sample-es-backup-1612440003   BackupConfiguration   sample-es-backup   Succeeded   54s
</code></pre></div><p>Here, the phase <code>Succeeded</code> means that the backup process has been completed successfully.</p><h3 id=verify-backup>Verify Backup</h3><p>Now, we are going to verify whether the backed up data is present in the backend or not. Once a backup is completed, Stash will update the respective <code>Repository</code> object to reflect the backup completion. Check that the repository <code>gcs-repo</code> has been updated by the following command,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get repository -n demo gcs-repo
NAME       INTEGRITY   SIZE        SNAPSHOT-COUNT   LAST-SUCCESSFUL-BACKUP   AGE
gcs-repo   true        3.801 KiB   <span style=color:#ae81ff>1</span>                64s                      3m46s
</code></pre></div><p>Now, if we navigate to the GCS bucket, we will see the backed up data has been stored in <code>demo/sample-es</code> directory as specified by the <code>.spec.backend.gcs.prefix</code> field of the <code>Repository</code> object.</p><figure align=center><img alt="Backup data in GCS Bucket" src=/docs/v2021.03.17/guides/elasticsearch/backup/kubedb/images/sample-es-backup.png><figcaption align=center>Fig: Backup data in GCS Bucket</figcaption></figure><blockquote><p>Note: Stash keeps all the backed up data encrypted. So, data in the backend will not make any sense until they are decrypted.</p></blockquote><h2 id=restore>Restore</h2><p>If you have followed the previous sections properly, you should have a successful backup of your Elasticsearch database. Now, we are going to show how you can restore the database from the backed up data.</p><h3 id=restore-into-the-same-elasticsearch>Restore into the same Elasticsearch</h3><p>You can restore your data into the same database you have backed up from or into a different database in the same cluster or a different cluster. In this section, we are going to show you how to restore in the same database which may be necessary when you have accidentally deleted any data from the running database.</p><h4 id=temporarily-pause-backup>Temporarily pause backup</h4><p>At first, let&rsquo;s stop taking any further backup of the database so that no backup runs after we delete the sample data. We are going to pause the <code>BackupConfiguration</code> object. Stash will stop taking any further backup when the <code>BackupConfiguration</code> is paused.</p><p>Let&rsquo;s pause the <code>sample-es-backup</code> BackupConfiguration,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl patch backupconfiguration -n demo sample-es-backup --type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;merge&#34;</span> --patch<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{&#34;spec&#34;: {&#34;paused&#34;: true}}&#39;</span>
backupconfiguration.stash.appscode.com/sample-es-backup patched
</code></pre></div><p>Verify that the <code>BackupConfiguration</code> has been paused,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get backupconfiguration -n demo sample-es-backup
NAME               TASK                         SCHEDULE      PAUSED   AGE
sample-es-backup   elasticsearch-backup-7.3.2   */5 * * * *   true     12m
</code></pre></div><p>Notice the <code>PAUSED</code> column. Value <code>true</code> for this field means that the <code>BackupConfiguration</code> has been paused.</p><p>Stash will also suspend the respective CronJob.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get cronjob -n demo
NAME                            SCHEDULE      SUSPEND   ACTIVE   LAST SCHEDULE   AGE
stash-backup-sample-es-backup   */5 * * * *   True      <span style=color:#ae81ff>0</span>        5m19s           12m
</code></pre></div><h4 id=simulate-disaster>Simulate Disaster</h4><p>Now, let&rsquo;s simulate an accidental deletion scenario. Here, we are going to delete the <code>products</code> and <code>companies</code> indexes that we had created earlier.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Delete &#34;products&#34; index</span>
❯ curl -XDELETE --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/products?pretty&#34;</span>
<span style=color:#f92672>{</span>
  <span style=color:#e6db74>&#34;acknowledged&#34;</span> : true
<span style=color:#f92672>}</span>

<span style=color:#75715e># Delete &#34;companies&#34; index</span>
❯ curl -XDELETE --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/companies?pretty&#34;</span>
<span style=color:#f92672>{</span>
  <span style=color:#e6db74>&#34;acknowledged&#34;</span> : true
<span style=color:#f92672>}</span>
</code></pre></div><p>Now, let&rsquo;s verify that the indexes have been deleted from the database,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ curl -XGET --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/_cat/indices?v&amp;s=index&amp;pretty&#34;</span>
health status index uuid pri rep docs.count docs.deleted store.size pri.store.size
</code></pre></div><p>So, we can see our <code>sample-es</code> database does not have any indexes. In the next section, we are going to restore the deleted indexes from backed up data.</p><h4 id=create-restoresession>Create RestoreSession</h4><p>To restore the database, you have to create a <code>RestoreSession</code> object pointing to the <code>AppBinding</code> of the targeted database.</p><p>Here, is the YAML of the <code>RestoreSession</code> object that we are going to use for restoring our <code>sample-es</code> database.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>stash.appscode.com/v1beta1</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>RestoreSession</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>sample-es-restore</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>demo</span>
<span style=color:#f92672>spec</span>:
  <span style=color:#f92672>repository</span>:
    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>gcs-repo</span>
  <span style=color:#f92672>target</span>:
    <span style=color:#f92672>ref</span>:
      <span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>appcatalog.appscode.com/v1alpha1</span>
      <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>AppBinding</span>
      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>sample-es</span>
  <span style=color:#f92672>interimVolumeTemplate</span>:
    <span style=color:#f92672>metadata</span>:
      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>sample-es-restore-tmp-storage</span>
    <span style=color:#f92672>spec</span>:
      <span style=color:#f92672>accessModes</span>: [ <span style=color:#e6db74>&#34;ReadWriteOnce&#34;</span> ]
      <span style=color:#f92672>storageClassName</span>: <span style=color:#e6db74>&#34;standard&#34;</span>
      <span style=color:#f92672>resources</span>:
        <span style=color:#f92672>requests</span>:
          <span style=color:#f92672>storage</span>: <span style=color:#ae81ff>1Gi</span>
  <span style=color:#f92672>rules</span>:
  - <span style=color:#f92672>snapshots</span>: [<span style=color:#ae81ff>latest]</span>
</code></pre></div><p>Here,</p><ul><li><code>.spec.repository.name</code> specifies the <code>Repository</code> object that holds the backend information where our backed up data has been stored.</li><li><code>.spec.target.ref</code> refers to the respective <code>AppBinding</code> of the <code>sample-es</code> database.</li><li><code>spec.interimVolumeTemplate</code> specifies a PVC template that will be used by Stash to hold the restored data temporarily before injecting it into the database.</li><li><code>.spec.rules</code> specifies that we are restoring data from the latest backup snapshot of the database.</li></ul><p>Let&rsquo;s create the <code>RestoreSession</code> object object we have shown above,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl apply -f https://github.com/kubedb/docs/raw/v2021.03.17/docs/guides/elasticsearch/backup/kubedb/examples/restore/restoresession.yaml
restoresession.stash.appscode.com/sample-es-restore created
</code></pre></div><p>Once, you have created the <code>RestoreSession</code> object, Stash will create a restore Job. Run the following command to watch the phase of the <code>RestoreSession</code> object,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get restoresession -n demo -w
NAME                REPOSITORY   PHASE       AGE
sample-es-restore   gcs-repo     Running     8s
sample-es-restore   gcs-repo     Running     24s
sample-es-restore   gcs-repo     Succeeded   24s
sample-es-restore   gcs-repo     Succeeded   25s
</code></pre></div><p>The <code>Succeeded</code> phase means that the restore process has been completed successfully.</p><h4 id=verify-restored-data>Verify Restored Data</h4><p>Now, it&rsquo;s time to verify whether the actual data has been restored or not. At first, let&rsquo;s verify that whether the indexes have been restored or not:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ curl -XGET --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/_cat/indices?v&amp;s=index&amp;pretty&#34;</span>
health status index     uuid                   pri rep docs.count docs.deleted store.size pri.store.size
green  open   companies 7UgxlL4wST6ZIAImxRVvzw   <span style=color:#ae81ff>1</span>   <span style=color:#ae81ff>1</span>          <span style=color:#ae81ff>1</span>            <span style=color:#ae81ff>0</span>     11.4kb          5.7kb
green  open   products  vb19PIneSL2zMTPvNEgm-w   <span style=color:#ae81ff>1</span>   <span style=color:#ae81ff>1</span>          <span style=color:#ae81ff>2</span>            <span style=color:#ae81ff>0</span>     10.8kb          5.4kb
</code></pre></div><p>So, we can see the indexes have been restored. Now, let&rsquo;s verify the data of these indexes,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Verify the data of the &#34;products&#34; index</span>
❯ curl -XGET --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/products/_search?pretty&#34;</span>
<span style=color:#f92672>{</span>
  <span style=color:#e6db74>&#34;took&#34;</span> : 3,
  <span style=color:#e6db74>&#34;timed_out&#34;</span> : false,
  <span style=color:#e6db74>&#34;_shards&#34;</span> : <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;total&#34;</span> : 1,
    <span style=color:#e6db74>&#34;successful&#34;</span> : 1,
    <span style=color:#e6db74>&#34;skipped&#34;</span> : 0,
    <span style=color:#e6db74>&#34;failed&#34;</span> : <span style=color:#ae81ff>0</span>
  <span style=color:#f92672>}</span>,
  <span style=color:#e6db74>&#34;hits&#34;</span> : <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;total&#34;</span> : <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;value&#34;</span> : 2,
      <span style=color:#e6db74>&#34;relation&#34;</span> : <span style=color:#e6db74>&#34;eq&#34;</span>
    <span style=color:#f92672>}</span>,
    <span style=color:#e6db74>&#34;max_score&#34;</span> : 1.0,
    <span style=color:#e6db74>&#34;hits&#34;</span> : <span style=color:#f92672>[</span>
      <span style=color:#f92672>{</span>
        <span style=color:#e6db74>&#34;_index&#34;</span> : <span style=color:#e6db74>&#34;products&#34;</span>,
        <span style=color:#e6db74>&#34;_type&#34;</span> : <span style=color:#e6db74>&#34;_doc&#34;</span>,
        <span style=color:#e6db74>&#34;_id&#34;</span> : <span style=color:#e6db74>&#34;vKDVgXcBa1PZYKwIDBjy&#34;</span>,
        <span style=color:#e6db74>&#34;_score&#34;</span> : 1.0,
        <span style=color:#e6db74>&#34;_source&#34;</span> : <span style=color:#f92672>{</span>
          <span style=color:#e6db74>&#34;name&#34;</span> : <span style=color:#e6db74>&#34;Stash&#34;</span>,
          <span style=color:#e6db74>&#34;vendor&#34;</span> : <span style=color:#e6db74>&#34;AppsCode Inc.&#34;</span>,
          <span style=color:#e6db74>&#34;description&#34;</span> : <span style=color:#e6db74>&#34;Backup tool for Kubernetes workloads&#34;</span>
        <span style=color:#f92672>}</span>
      <span style=color:#f92672>}</span>,
      <span style=color:#f92672>{</span>
        <span style=color:#e6db74>&#34;_index&#34;</span> : <span style=color:#e6db74>&#34;products&#34;</span>,
        <span style=color:#e6db74>&#34;_type&#34;</span> : <span style=color:#e6db74>&#34;_doc&#34;</span>,
        <span style=color:#e6db74>&#34;_id&#34;</span> : <span style=color:#e6db74>&#34;u6DUgXcBa1PZYKwI5xic&#34;</span>,
        <span style=color:#e6db74>&#34;_score&#34;</span> : 1.0,
        <span style=color:#e6db74>&#34;_source&#34;</span> : <span style=color:#f92672>{</span>
          <span style=color:#e6db74>&#34;name&#34;</span> : <span style=color:#e6db74>&#34;KubeDB&#34;</span>,
          <span style=color:#e6db74>&#34;vendor&#34;</span> : <span style=color:#e6db74>&#34;AppsCode Inc.&#34;</span>,
          <span style=color:#e6db74>&#34;description&#34;</span> : <span style=color:#e6db74>&#34;Database Operator for Kubernetes&#34;</span>
        <span style=color:#f92672>}</span>
      <span style=color:#f92672>}</span>
    <span style=color:#f92672>]</span>
  <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>

<span style=color:#75715e># Verify the data of &#34;companies&#34; index</span>
❯ curl -XGET --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/companies/_search?pretty&#34;</span>
<span style=color:#f92672>{</span>
  <span style=color:#e6db74>&#34;took&#34;</span> : 2,
  <span style=color:#e6db74>&#34;timed_out&#34;</span> : false,
  <span style=color:#e6db74>&#34;_shards&#34;</span> : <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;total&#34;</span> : 1,
    <span style=color:#e6db74>&#34;successful&#34;</span> : 1,
    <span style=color:#e6db74>&#34;skipped&#34;</span> : 0,
    <span style=color:#e6db74>&#34;failed&#34;</span> : <span style=color:#ae81ff>0</span>
  <span style=color:#f92672>}</span>,
  <span style=color:#e6db74>&#34;hits&#34;</span> : <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;total&#34;</span> : <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;value&#34;</span> : 1,
      <span style=color:#e6db74>&#34;relation&#34;</span> : <span style=color:#e6db74>&#34;eq&#34;</span>
    <span style=color:#f92672>}</span>,
    <span style=color:#e6db74>&#34;max_score&#34;</span> : 1.0,
    <span style=color:#e6db74>&#34;hits&#34;</span> : <span style=color:#f92672>[</span>
      <span style=color:#f92672>{</span>
        <span style=color:#e6db74>&#34;_index&#34;</span> : <span style=color:#e6db74>&#34;companies&#34;</span>,
        <span style=color:#e6db74>&#34;_type&#34;</span> : <span style=color:#e6db74>&#34;_doc&#34;</span>,
        <span style=color:#e6db74>&#34;_id&#34;</span> : <span style=color:#e6db74>&#34;vaDVgXcBa1PZYKwIMxhm&#34;</span>,
        <span style=color:#e6db74>&#34;_score&#34;</span> : 1.0,
        <span style=color:#e6db74>&#34;_source&#34;</span> : <span style=color:#f92672>{</span>
          <span style=color:#e6db74>&#34;name&#34;</span> : <span style=color:#e6db74>&#34;AppsCode Inc.&#34;</span>,
          <span style=color:#e6db74>&#34;mission&#34;</span> : <span style=color:#e6db74>&#34;Accelerate the transition to Containers by building a Kubernetes-native Data Platform&#34;</span>,
          <span style=color:#e6db74>&#34;products&#34;</span> : <span style=color:#f92672>[</span>
            <span style=color:#e6db74>&#34;KubeDB&#34;</span>,
            <span style=color:#e6db74>&#34;Stash&#34;</span>,
            <span style=color:#e6db74>&#34;KubeVault&#34;</span>,
            <span style=color:#e6db74>&#34;Kubeform&#34;</span>,
            <span style=color:#e6db74>&#34;ByteBuilders&#34;</span>
          <span style=color:#f92672>]</span>
        <span style=color:#f92672>}</span>
      <span style=color:#f92672>}</span>
    <span style=color:#f92672>]</span>
  <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>So, we can see that the data has been restored as well.</p><h4 id=resume-backup>Resume Backup</h4><p>Since our data has been restored successfully we can now resume our usual backup process. Resume the <code>BackupConfiguration</code> using following command,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl patch backupconfiguration -n demo sample-es-backup --type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;merge&#34;</span> --patch<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{&#34;spec&#34;: {&#34;paused&#34;: false}}&#39;</span>
backupconfiguration.stash.appscode.com/sample-es-backup patched
</code></pre></div><p>Verify that the <code>BackupConfiguration</code> has been resumed,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get backupconfiguration -n demo sample-es-backup
NAME               TASK                         SCHEDULE      PAUSED   AGE
sample-es-backup   elasticsearch-backup-7.3.2   */5 * * * *   false    30m
</code></pre></div><p>Here, <code>false</code> in the <code>PAUSED</code> column means the backup has been resume successfully. The CronJob also should be resumed now.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get cronjob -n demo
NAME                            SCHEDULE      SUSPEND   ACTIVE   LAST SCHEDULE   AGE
stash-backup-sample-es-backup   */5 * * * *   False     <span style=color:#ae81ff>0</span>        2m50s           30m
</code></pre></div><p>Here, <code>False</code> in the <code>SUSPEND</code> column means the CronJob is no longer suspended and will trigger in the next schedule.</p><h3 id=restore-into-a-different-elasticsearch>Restore into a different Elasticsearch</h3><p>Now, we are going to restore the backed up data into a different Elasticsearch of a different namespace. This time, we are going to use <code>opendistro</code> variant for Elasticsearch to demonstrate migration between the variants. You can use the same variant of Elasticsearch if you are not considering to migrate from your current variant.</p><p>We are going to restore the data into an Elasticsearch in <code>restored</code> namespace. If you already don&rsquo;t have the namespace, let&rsquo;s create it first.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl create ns restored
namespace/restored created
</code></pre></div><h4 id=install-stash-kubectl-plugin>Install <code>stash</code> kubectl plugin</h4><p>Now, we are going to use <code>stash</code> kubectl plugin to help us copying the <code>Repository</code> and backend <code>Secret</code> from our <code>demo</code> namespace into <code>restored</code> namespace. If you haven&rsquo;t already installed the <code>stash</code> kubectl-plugin, please install it by following the guide from <a href=https://stash.run/docs/latest/setup/install/kubectl_plugin/>here</a>.</p><p>Verify that the <code>stash</code> kubectl plugin has been installed properly,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl stash version
Version <span style=color:#f92672>=</span> v0.11.9
VersionStrategy <span style=color:#f92672>=</span> tag
GitTag <span style=color:#f92672>=</span> v0.11.9
GitBranch <span style=color:#f92672>=</span> HEAD
CommitHash <span style=color:#f92672>=</span> 05511503bab90e48514aed24457458456876dfcf
CommitTimestamp <span style=color:#f92672>=</span> 2021-01-21T22:12:04
GoVersion <span style=color:#f92672>=</span> go1.15.6
Compiler <span style=color:#f92672>=</span> gcc
Platform <span style=color:#f92672>=</span> linux/amd64
</code></pre></div><h4 id=copy-repository-and-backend-secret-into-the-new-namespace>Copy Repository and backend Secret into the new namespace</h4><p>Now, let&rsquo;s copy the <code>gcs-repo</code> Repository into our new namespace using the <code>stash</code> kubectl plugin,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl stash cp repository gcs-repo -n demo --to-namespace<span style=color:#f92672>=</span>restored
I0208 19:51:43.950560  <span style=color:#ae81ff>666626</span> copy_repository.go:58<span style=color:#f92672>]</span> Repository demo/gcs-repo uses Storage Secret demo/gcs-secret.
I0208 19:51:43.952899  <span style=color:#ae81ff>666626</span> copy_secret.go:60<span style=color:#f92672>]</span> Copying Storage Secret demo to restored namespace
I0208 19:51:43.957204  <span style=color:#ae81ff>666626</span> copy_secret.go:73<span style=color:#f92672>]</span> Secret demo/gcs-secret has been copied to restored namespace successfully.
I0208 19:51:43.967768  <span style=color:#ae81ff>666626</span> copy_repository.go:75<span style=color:#f92672>]</span> Repository demo/gcs-repo has been copied to restored namespace successfully.
</code></pre></div><p>The above command will copy the <code>gcs-repo</code> Repository as well as the respective backend secret <code>gcs-secret</code>.</p><p>Let&rsquo;s verify that the <code>Repository</code> has been copied into <code>restored</code> namespace,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get repository -n restored
NAME       INTEGRITY   SIZE   SNAPSHOT-COUNT   LAST-SUCCESSFUL-BACKUP   AGE
gcs-repo                                                                2m9s
</code></pre></div><blockquote><p>The command does not copy the status of the <code>Repository</code>. As a result, you will see the <code>INTEGRITY</code>, <code>SIZE</code>, <code>SNAPSHOT-COUNT</code>, and <code>LAST-SUCCESSFUL-BACKUP</code> fields are empty. Nothing to panic about here. Your actual data exist safely in the cloud bucket. The <code>Repository</code> just contains the connection information to that bucket.</p></blockquote><p>Now, let&rsquo;s verify that the backend secret has been copied as well,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get secret -n restored
NAME                  TYPE                                  DATA   AGE
default-token-rd2v5   kubernetes.io/service-account-token   <span style=color:#ae81ff>3</span>      15m
gcs-secret            Opaque                                <span style=color:#ae81ff>3</span>      8m36s
</code></pre></div><p>As you can see, the backend secret <code>gcs-secret</code> also has been copied to <code>restored</code> namespace.</p><h4 id=deploy-new-elasticsearch>Deploy new Elasticsearch</h4><p>Now, we are going to deploy an Elasticsearch into <code>restored</code> namespace. We are going to initialize this database from the backed up data of first Elasticsearch.</p><p>Here, is the YAML of the Elasticsearch object that we are going to create,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>kubedb.com/v1alpha2</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Elasticsearch</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>init-sample</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>restored</span>
<span style=color:#f92672>spec</span>:
  <span style=color:#f92672>version</span>: <span style=color:#ae81ff>opendistro-1.11.0</span>
  <span style=color:#f92672>storageType</span>: <span style=color:#ae81ff>Durable</span>
  <span style=color:#f92672>init</span>:
    <span style=color:#f92672>waitForInitialRestore</span>: <span style=color:#66d9ef>true</span>
  <span style=color:#f92672>topology</span>:
    <span style=color:#f92672>master</span>:
      <span style=color:#f92672>suffix</span>: <span style=color:#ae81ff>master</span>
      <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
      <span style=color:#f92672>storage</span>:
        <span style=color:#f92672>storageClassName</span>: <span style=color:#e6db74>&#34;standard&#34;</span>
        <span style=color:#f92672>accessModes</span>:
        - <span style=color:#ae81ff>ReadWriteOnce</span>
        <span style=color:#f92672>resources</span>:
          <span style=color:#f92672>requests</span>:
            <span style=color:#f92672>storage</span>: <span style=color:#ae81ff>1Gi</span>
    <span style=color:#f92672>data</span>:
      <span style=color:#f92672>suffix</span>: <span style=color:#ae81ff>data</span>
      <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>2</span>
      <span style=color:#f92672>storage</span>:
        <span style=color:#f92672>storageClassName</span>: <span style=color:#e6db74>&#34;standard&#34;</span>
        <span style=color:#f92672>accessModes</span>:
        - <span style=color:#ae81ff>ReadWriteOnce</span>
        <span style=color:#f92672>resources</span>:
          <span style=color:#f92672>requests</span>:
            <span style=color:#f92672>storage</span>: <span style=color:#ae81ff>1Gi</span>
    <span style=color:#f92672>ingest</span>:
      <span style=color:#f92672>suffix</span>: <span style=color:#ae81ff>client</span>
      <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>2</span>
      <span style=color:#f92672>storage</span>:
        <span style=color:#f92672>storageClassName</span>: <span style=color:#e6db74>&#34;standard&#34;</span>
        <span style=color:#f92672>accessModes</span>:
        - <span style=color:#ae81ff>ReadWriteOnce</span>
        <span style=color:#f92672>resources</span>:
          <span style=color:#f92672>requests</span>:
            <span style=color:#f92672>storage</span>: <span style=color:#ae81ff>1Gi</span>
</code></pre></div><p>Notice that this time, we are using <code>1.9.0-opendistro</code> variant for Elasticsearch. Also, notice that we have added an <code>init</code> section in the <code>spec</code>. Here, <code>waitForInitialRestore: true</code> tells KubeDB to wait for the first restore to complete before marking this database as ready to use.</p><p>Let&rsquo;s deploy the above Elasticsearch,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl apply -f https://github.com/kubedb/docs/raw/v2021.03.17/docs/guides/elasticsearch/backup/kubedb/examples/elasticsearch/init_sample.yaml
elasticsearch.kubedb.com/init-sample created
</code></pre></div><p>Now, wait for the KubeDB to create all the nodes for this Elasticsearch. This time, Elasticsearch will get stuck in the <code>Provisioning</code> state because we haven&rsquo;t completed the first restore yet.</p><p>You can check the condition of the Elasticsearch to verify whether we are ready to restore the database.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get elasticsearch -n restored init-sample -o jsonpath<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{.status.conditions}&#39;</span> | jq
<span style=color:#f92672>[</span>
  <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;lastTransitionTime&#34;</span>: <span style=color:#e6db74>&#34;2021-02-08T14:13:22Z&#34;</span>,
    <span style=color:#e6db74>&#34;message&#34;</span>: <span style=color:#e6db74>&#34;The KubeDB operator has started the provisioning of Elasticsearch: restored/init-sample&#34;</span>,
    <span style=color:#e6db74>&#34;reason&#34;</span>: <span style=color:#e6db74>&#34;DatabaseProvisioningStartedSuccessfully&#34;</span>,
    <span style=color:#e6db74>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;True&#34;</span>,
    <span style=color:#e6db74>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;ProvisioningStarted&#34;</span>
  <span style=color:#f92672>}</span>,
  <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;lastTransitionTime&#34;</span>: <span style=color:#e6db74>&#34;2021-02-08T14:18:15Z&#34;</span>,
    <span style=color:#e6db74>&#34;message&#34;</span>: <span style=color:#e6db74>&#34;All desired replicas are ready.&#34;</span>,
    <span style=color:#e6db74>&#34;reason&#34;</span>: <span style=color:#e6db74>&#34;AllReplicasReady&#34;</span>,
    <span style=color:#e6db74>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;True&#34;</span>,
    <span style=color:#e6db74>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;ReplicaReady&#34;</span>
  <span style=color:#f92672>}</span>,
  <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;lastTransitionTime&#34;</span>: <span style=color:#e6db74>&#34;2021-02-08T14:19:22Z&#34;</span>,
    <span style=color:#e6db74>&#34;message&#34;</span>: <span style=color:#e6db74>&#34;The Elasticsearch: restored/init-sample is accepting client requests.&#34;</span>,
    <span style=color:#e6db74>&#34;observedGeneration&#34;</span>: 3,
    <span style=color:#e6db74>&#34;reason&#34;</span>: <span style=color:#e6db74>&#34;DatabaseAcceptingConnectionRequest&#34;</span>,
    <span style=color:#e6db74>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;True&#34;</span>,
    <span style=color:#e6db74>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;AcceptingConnection&#34;</span>
  <span style=color:#f92672>}</span>,
  <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;lastTransitionTime&#34;</span>: <span style=color:#e6db74>&#34;2021-02-08T14:19:33Z&#34;</span>,
    <span style=color:#e6db74>&#34;message&#34;</span>: <span style=color:#e6db74>&#34;The Elasticsearch: restored/init-sample is ready.&#34;</span>,
    <span style=color:#e6db74>&#34;observedGeneration&#34;</span>: 3,
    <span style=color:#e6db74>&#34;reason&#34;</span>: <span style=color:#e6db74>&#34;ReadinessCheckSucceeded&#34;</span>,
    <span style=color:#e6db74>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;True&#34;</span>,
    <span style=color:#e6db74>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;Ready&#34;</span>
  <span style=color:#f92672>}</span>
<span style=color:#f92672>]</span>
</code></pre></div><p>Here, check the last two conditions. We can see that the database has passed the readiness check from <code>Ready</code> conditions and it is accepting connections from <code>AcceptingConnection</code> condition. So, we are good to start restoring into this database.</p><p>KubeDB has created an AppBinding for this database. Let&rsquo;s verify that the AppBinding has been created,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get appbindings.appcatalog.appscode.com -n restored
NAME          TYPE                       VERSION   AGE
init-sample   kubedb.com/elasticsearch   7.8.0     21m
</code></pre></div><p>We are going to create a <code>RestoreSession</code> targeting this AppBinding to restore into this database.</p><h4 id=create-restoresession-for-new-elasticsearch>Create RestoreSession for new Elasticsearch</h4><p>Now, we have to create a <code>RestoreSession</code> object targeting the <code>AppBinding</code> of our <code>init-sample</code> database. Here, is the YAML of the RestoreSession that we are going to create,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>stash.appscode.com/v1beta1</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>RestoreSession</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>init-sample-restore</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>restored</span>
<span style=color:#f92672>spec</span>:
  <span style=color:#f92672>repository</span>:
    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>gcs-repo</span>
  <span style=color:#f92672>target</span>:
    <span style=color:#f92672>ref</span>:
      <span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>appcatalog.appscode.com/v1alpha1</span>
      <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>AppBinding</span>
      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>init-sample</span>
  <span style=color:#f92672>interimVolumeTemplate</span>:
    <span style=color:#f92672>metadata</span>:
      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>init-sample-restore-tmp-storage</span>
    <span style=color:#f92672>spec</span>:
      <span style=color:#f92672>accessModes</span>: [ <span style=color:#e6db74>&#34;ReadWriteOnce&#34;</span> ]
      <span style=color:#f92672>storageClassName</span>: <span style=color:#e6db74>&#34;standard&#34;</span>
      <span style=color:#f92672>resources</span>:
        <span style=color:#f92672>requests</span>:
          <span style=color:#f92672>storage</span>: <span style=color:#ae81ff>1Gi</span>
  <span style=color:#f92672>rules</span>:
  - <span style=color:#f92672>snapshots</span>: [<span style=color:#ae81ff>latest]</span>
</code></pre></div><p>Let&rsquo;s create the above RestoreSession,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl apply -f https://github.com/kubedb/docs/raw/v2021.03.17/docs/guides/elasticsearch/backup/kubedb/examples/restore/init_sample_restore.yaml
restoresession.stash.appscode.com/init-sample-restore created
</code></pre></div><p>Now, wait for the restore process to complete,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get restoresession -n restored -w
NAME                  REPOSITORY   PHASE     AGE
init-sample-restore   gcs-repo     Running   4s
init-sample-restore   gcs-repo     Running   21s
init-sample-restore   gcs-repo     Succeeded   21s
init-sample-restore   gcs-repo     Succeeded   21s
</code></pre></div><h4 id=verify-restored-data-in-new-elasticsearch>Verify Restored Data in new Elasticsearch</h4><p>Now, we are going to verify whether the data has been restored or not. At first let&rsquo;s port-forward the respective Service for this Elasticsearch,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get service -n restored
NAME                 TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span style=color:#f92672>(</span>S<span style=color:#f92672>)</span>    AGE
init-sample          ClusterIP   10.109.51.219   &lt;none&gt;        9200/TCP   54m
init-sample-master   ClusterIP   None            &lt;none&gt;        9300/TCP   54m
init-sample-pods     ClusterIP   None            &lt;none&gt;        9200/TCP   54m
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl port-forward -n restored service/init-sample <span style=color:#ae81ff>9200</span>
Forwarding from 127.0.0.1:9200 -&gt; <span style=color:#ae81ff>9200</span>
Forwarding from <span style=color:#f92672>[</span>::1<span style=color:#f92672>]</span>:9200 -&gt; <span style=color:#ae81ff>9200</span>
</code></pre></div><p>Now, let&rsquo;s export the credentials of this Elasticsearch,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ kubectl get secret -n restored | grep init-sample
init-sample-admin-cred                            kubernetes.io/basic-auth              <span style=color:#ae81ff>2</span>      55m
init-sample-ca-cert                               kubernetes.io/tls                     <span style=color:#ae81ff>2</span>      55m
init-sample-config                                Opaque                                <span style=color:#ae81ff>3</span>      55m
init-sample-kibanaro-cred                         kubernetes.io/basic-auth              <span style=color:#ae81ff>2</span>      55m
init-sample-kibanaserver-cred                     kubernetes.io/basic-auth              <span style=color:#ae81ff>2</span>      55m
init-sample-logstash-cred                         kubernetes.io/basic-auth              <span style=color:#ae81ff>2</span>      55m
init-sample-readall-cred                          kubernetes.io/basic-auth              <span style=color:#ae81ff>2</span>      55m
init-sample-snapshotrestore-cred                  kubernetes.io/basic-auth              <span style=color:#ae81ff>2</span>      55m
init-sample-token-xgnrx                           kubernetes.io/service-account-token   <span style=color:#ae81ff>3</span>      55m
init-sample-transport-cert                        kubernetes.io/tls                     <span style=color:#ae81ff>3</span>      55m
stash-restore-init-sample-restore-0-token-vscdt   kubernetes.io/service-account-token   <span style=color:#ae81ff>3</span>      4m40s
</code></pre></div><p>Here, we are going to use the <code>init-sample-admin-cred</code> for connecting with the database. Let&rsquo;s export the <code>username</code> and <code>password</code> keys.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ export USER<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>kubectl get secrets -n restored init-sample-admin-cred -o jsonpath<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{.data.\username}&#39;</span> | base64 -d<span style=color:#66d9ef>)</span>
❯ export PASSWORD<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>kubectl get secrets -n restored init-sample-admin-cred -o jsonpath<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{.data.\password}&#39;</span> | base64 -d<span style=color:#66d9ef>)</span>
</code></pre></div><p>Now, let&rsquo;s verify whether the indexes have been restored or not.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ curl -XGET --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/_cat/indices?v&amp;s=index&amp;pretty&#34;</span>
health status index                uuid                   pri rep docs.count docs.deleted store.size pri.store.size
green  open   .opendistro_security _v-_YiJUReylNbUaIEXN8A   <span style=color:#ae81ff>1</span>   <span style=color:#ae81ff>1</span>          <span style=color:#ae81ff>7</span>            <span style=color:#ae81ff>0</span>     57.1kb         37.1kb
green  open   companies            XfSvxePuS7-lNq-gcd-bxg   <span style=color:#ae81ff>1</span>   <span style=color:#ae81ff>1</span>          <span style=color:#ae81ff>1</span>            <span style=color:#ae81ff>0</span>     11.1kb          5.5kb
green  open   products             pZYHzOp_TWK9bLaEU-uj8Q   <span style=color:#ae81ff>1</span>   <span style=color:#ae81ff>1</span>          <span style=color:#ae81ff>2</span>            <span style=color:#ae81ff>0</span>     10.5kb          5.2kb
</code></pre></div><p>So, we can see that our indexes have been restored successfully. Now, let&rsquo;s verify the data of these indexes.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Verify data of &#34;products&#34; index</span>
❯ curl -XGET --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/products/_search?pretty&#34;</span>
<span style=color:#f92672>{</span>
  <span style=color:#e6db74>&#34;took&#34;</span> : 634,
  <span style=color:#e6db74>&#34;timed_out&#34;</span> : false,
  <span style=color:#e6db74>&#34;_shards&#34;</span> : <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;total&#34;</span> : 1,
    <span style=color:#e6db74>&#34;successful&#34;</span> : 1,
    <span style=color:#e6db74>&#34;skipped&#34;</span> : 0,
    <span style=color:#e6db74>&#34;failed&#34;</span> : <span style=color:#ae81ff>0</span>
  <span style=color:#f92672>}</span>,
  <span style=color:#e6db74>&#34;hits&#34;</span> : <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;total&#34;</span> : <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;value&#34;</span> : 2,
      <span style=color:#e6db74>&#34;relation&#34;</span> : <span style=color:#e6db74>&#34;eq&#34;</span>
    <span style=color:#f92672>}</span>,
    <span style=color:#e6db74>&#34;max_score&#34;</span> : 1.0,
    <span style=color:#e6db74>&#34;hits&#34;</span> : <span style=color:#f92672>[</span>
      <span style=color:#f92672>{</span>
        <span style=color:#e6db74>&#34;_index&#34;</span> : <span style=color:#e6db74>&#34;products&#34;</span>,
        <span style=color:#e6db74>&#34;_type&#34;</span> : <span style=color:#e6db74>&#34;_doc&#34;</span>,
        <span style=color:#e6db74>&#34;_id&#34;</span> : <span style=color:#e6db74>&#34;u6DUgXcBa1PZYKwI5xic&#34;</span>,
        <span style=color:#e6db74>&#34;_score&#34;</span> : 1.0,
        <span style=color:#e6db74>&#34;_source&#34;</span> : <span style=color:#f92672>{</span>
          <span style=color:#e6db74>&#34;name&#34;</span> : <span style=color:#e6db74>&#34;KubeDB&#34;</span>,
          <span style=color:#e6db74>&#34;vendor&#34;</span> : <span style=color:#e6db74>&#34;AppsCode Inc.&#34;</span>,
          <span style=color:#e6db74>&#34;description&#34;</span> : <span style=color:#e6db74>&#34;Database Operator for Kubernetes&#34;</span>
        <span style=color:#f92672>}</span>
      <span style=color:#f92672>}</span>,
      <span style=color:#f92672>{</span>
        <span style=color:#e6db74>&#34;_index&#34;</span> : <span style=color:#e6db74>&#34;products&#34;</span>,
        <span style=color:#e6db74>&#34;_type&#34;</span> : <span style=color:#e6db74>&#34;_doc&#34;</span>,
        <span style=color:#e6db74>&#34;_id&#34;</span> : <span style=color:#e6db74>&#34;vKDVgXcBa1PZYKwIDBjy&#34;</span>,
        <span style=color:#e6db74>&#34;_score&#34;</span> : 1.0,
        <span style=color:#e6db74>&#34;_source&#34;</span> : <span style=color:#f92672>{</span>
          <span style=color:#e6db74>&#34;name&#34;</span> : <span style=color:#e6db74>&#34;Stash&#34;</span>,
          <span style=color:#e6db74>&#34;vendor&#34;</span> : <span style=color:#e6db74>&#34;AppsCode Inc.&#34;</span>,
          <span style=color:#e6db74>&#34;description&#34;</span> : <span style=color:#e6db74>&#34;Backup tool for Kubernetes workloads&#34;</span>
        <span style=color:#f92672>}</span>
      <span style=color:#f92672>}</span>
    <span style=color:#f92672>]</span>
  <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>

<span style=color:#75715e># Verify data of &#34;companies&#34; index</span>
❯ curl -XGET --user <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>:</span>$PASSWORD<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;http://localhost:9200/companies/_search?pretty&#34;</span>
<span style=color:#f92672>{</span>
  <span style=color:#e6db74>&#34;took&#34;</span> : 5,
  <span style=color:#e6db74>&#34;timed_out&#34;</span> : false,
  <span style=color:#e6db74>&#34;_shards&#34;</span> : <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;total&#34;</span> : 1,
    <span style=color:#e6db74>&#34;successful&#34;</span> : 1,
    <span style=color:#e6db74>&#34;skipped&#34;</span> : 0,
    <span style=color:#e6db74>&#34;failed&#34;</span> : <span style=color:#ae81ff>0</span>
  <span style=color:#f92672>}</span>,
  <span style=color:#e6db74>&#34;hits&#34;</span> : <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;total&#34;</span> : <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;value&#34;</span> : 1,
      <span style=color:#e6db74>&#34;relation&#34;</span> : <span style=color:#e6db74>&#34;eq&#34;</span>
    <span style=color:#f92672>}</span>,
    <span style=color:#e6db74>&#34;max_score&#34;</span> : 1.0,
    <span style=color:#e6db74>&#34;hits&#34;</span> : <span style=color:#f92672>[</span>
      <span style=color:#f92672>{</span>
        <span style=color:#e6db74>&#34;_index&#34;</span> : <span style=color:#e6db74>&#34;companies&#34;</span>,
        <span style=color:#e6db74>&#34;_type&#34;</span> : <span style=color:#e6db74>&#34;_doc&#34;</span>,
        <span style=color:#e6db74>&#34;_id&#34;</span> : <span style=color:#e6db74>&#34;vaDVgXcBa1PZYKwIMxhm&#34;</span>,
        <span style=color:#e6db74>&#34;_score&#34;</span> : 1.0,
        <span style=color:#e6db74>&#34;_source&#34;</span> : <span style=color:#f92672>{</span>
          <span style=color:#e6db74>&#34;name&#34;</span> : <span style=color:#e6db74>&#34;AppsCode Inc.&#34;</span>,
          <span style=color:#e6db74>&#34;mission&#34;</span> : <span style=color:#e6db74>&#34;Accelerate the transition to Containers by building a Kubernetes-native Data Platform&#34;</span>,
          <span style=color:#e6db74>&#34;products&#34;</span> : <span style=color:#f92672>[</span>
            <span style=color:#e6db74>&#34;KubeDB&#34;</span>,
            <span style=color:#e6db74>&#34;Stash&#34;</span>,
            <span style=color:#e6db74>&#34;KubeVault&#34;</span>,
            <span style=color:#e6db74>&#34;Kubeform&#34;</span>,
            <span style=color:#e6db74>&#34;ByteBuilders&#34;</span>
          <span style=color:#f92672>]</span>
        <span style=color:#f92672>}</span>
      <span style=color:#f92672>}</span>
    <span style=color:#f92672>]</span>
  <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>So, we can see that the data of these indexes data has been restored too.</p><h3 id=restore-into-a-different-cluster>Restore into a different cluster</h3><p>If you want to restore into a different cluster, you have to install KubeDB and Stash in the desired cluster. Then, you have to install Stash Elasticsearch addon in that cluster too. Then, you have to deploy the target database there. Once, the database is ready to accept connections, create the Repository, backend Secret, in the same namespace as the database of your desired cluster. Finally, create the <code>RestoreSession</code> object in the desired cluster pointing to the AppBinding of the targeted database of that cluster.</p><h2 id=cleanup>Cleanup</h2><p>To cleanup the Kubernetes resources created by this tutorial, run:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># delete all reasources from &#34;demo&#34; namespace</span>
kubectl delete -n demo backupconfiguration sample-es-backup
kubectl delete -n demo restoresession sample-es-restore
kubectl delete -n demo repository gcs-repo
kubectl delete -n demo secret gcs-repo
kubectl delete -n demo secret gcs-secret
kubectl delete -n demo elasticsearch  sample-es

<span style=color:#75715e># delete all reasources from &#34;restored&#34; namespace</span>
kubectl delete -n restored restoresession init-sample-restore
kubectl delete -n restored repository gcs-repo
kubectl delete -n restored secret gcs-secret
kubectl delete -n restored elasticsearch  init-sample
</code></pre></div></div></div><div class="column is-2"><div class=right-sidebar-area><div class=search-area><form action=#><input id=acSearch type=text placeholder=Search...>
<button class=search-button>
<i class="fa fa-search" aria-hidden=true></i></button></form></div><div class=tbl-of-contents><h4>What's on this Page</h4><nav id=TableOfContents><ul><li><a href=#before-you-begin>Before You Begin</a></li><li><a href=#prepare-elasticsearch>Prepare Elasticsearch</a><ul><li><a href=#deploy-elasticsearch>Deploy Elasticsearch</a></li><li><a href=#insert-sample-data>Insert Sample Data</a></li></ul></li><li><a href=#prepare-for-backup>Prepare for Backup</a><ul><li><a href=#verify-appbinding>Verify AppBinding</a></li><li><a href=#verify-stash-elasticsearch-addons-installed>Verify Stash Elasticsearch Addons Installed</a></li><li><a href=#prepare-backend>Prepare Backend</a></li></ul></li><li><a href=#backup>Backup</a><ul><li><a href=#create-backupconfiguration>Create BackupConfiguration</a></li><li><a href=#verify-cronjob>Verify CronJob</a></li><li><a href=#wait-for-backupsession>Wait for BackupSession</a></li><li><a href=#verify-backup>Verify Backup</a></li></ul></li><li><a href=#restore>Restore</a><ul><li><a href=#restore-into-the-same-elasticsearch>Restore into the same Elasticsearch</a></li><li><a href=#restore-into-a-different-elasticsearch>Restore into a different Elasticsearch</a></li><li><a href=#restore-into-a-different-cluster>Restore into a different cluster</a></li></ul></li><li><a href=#cleanup>Cleanup</a></li></ul></nav></div></div></div></div></div><script>var kdDropdown=document.querySelector(".dropdown"),kdDropdownBtn=document.querySelector(".dropdown-trigger");kdDropdownBtn.addEventListener("click",function(){kdDropdown.classList.toggle("is-active")})</script></div><div class=overlay-bg></div><div class=sidebar-search-area><div class=search-area-top><h3>Search</h3><div class=searchbar-area><input type=search name=search id=searchbox placeholder=Search...>
<button onclick=queryPage(1)><i class="fa fa-search" aria-hidden=true></i></button></div><span id=searchbar-script-container style=display:none></span><div class="search-meta-information level"><div class=level-left></div></div></div><div class=search-result-wrapper></div><div class=pagination-area><div class=pagination-list></div></div></div><div class=improve-section-area><div class="container section"><div class=improve-bg-color><div class=columns><div class="column is-6"><a href=https://github.com/kubedb/docs/edit/master/docs/guides/elasticsearch/backup/kubedb/index.md/>Improve This Page</a></div></div></div></div></div><script type=text/javascript>var pageSize=5,acSearch=document.querySelector("#acSearch"),bodyOverlay=document.querySelector(".overlay-bg"),sidebarSearch=document.querySelector(".sidebar-search-area");acSearch.addEventListener("click",function(){bodyOverlay.style.display="block",sidebarSearch.style.right="0",document.getElementById("searchbox").focus(),bodyOverlay.addEventListener("click",function(){bodyOverlay.style.display="none",sidebarSearch.style.right="-80%"})});function encodeQueryData(a){var b=[],c;for(c in a)b.push(encodeURIComponent(c)+'='+encodeURIComponent(a[c]));return b.join('&')}document.querySelector(".searchbar-area input[type=search]").addEventListener("keyup",function(a){a.preventDefault(),a.keyCode===13&&queryPage(1)});function queryPage(c){var i=document.getElementById("searchbox").value,j="015199383701854252104:8mvwy0fek2e",d="AIzaSyBrcwLTnL09geNrFMUx1kpL--dT1379aag",f="small",g="renderResult",h="https://www.googleapis.com/customsearch/v1?"+encodeQueryData({q:i,cx:j,key:d,imgSize:f,callback:g,start:(c-1)*pageSize+1,num:pageSize}),a=document.createElement("script"),b;a.src=h,e=document.getElementById("searchbar-script-container"),b=e.lastElementChild,b&&e.removeChild(b),e.appendChild(a)}function renderSearchResultEntry(a){var b='<div class="single-search-result"><h3><a href="'+a.link+'">'+a.title+'</a></h3>'+'<a href="'+a.link+'">'+a.htmlFormattedUrl+'</a>'+'<div class="result-description-wrapper">';return a.pagemap&&a.pagemap.cse_thumbnail&&(b+='<div class="result-thumb"><img src="'+a.pagemap.cse_thumbnail[0].src+'" alt="" />'+'</div>'),b+='<div class="result-description"><p>'+a.snippet+'</p>'+'</div>'+'</div>'+'</div>',b}function renderResult(a){var e,d,c,b;if(document.querySelector(".search-meta-information .level-left").innerHTML='<div class="level-left"><p>About <span class="search-count">'+a.searchInformation.formattedTotalResults+'</span> results (<span class="time-count">'+a.searchInformation.formattedSearchTime+' </span>seconds)'+'</p>'+'</div>',!a.items)return;e=document.querySelector(".search-result-wrapper"),e.innerHTML="";for(d=0;d<a.items.length;d++)e.innerHTML+=renderSearchResultEntry(a.items[d]);c='<ul>',a.queries.previousPage&&(b=Math.floor(a.queries.previousPage[0].startIndex/pageSize)+1,c+='<li><a href="#" onclick="queryPage('+b+')">Previous</a></li>'),a.queries.request&&(b=Math.floor(a.queries.request[0].startIndex/pageSize)+1,c+='<li><a href="#" onclick="queryPage('+b+')" class="is-active">'+b+'</a></li>'),a.queries.nextPage&&(b=Math.floor(a.queries.nextPage[0].startIndex/pageSize)+1,c+='<li><a href="#" onclick="queryPage('+b+')">Next</a></li>'),c+='</ul>',document.querySelector(".pagination-area .pagination-list").innerHTML=c}</script><section></section><section></section><section></section><button class=go-to-top id=goTop>
<i class="fa fa-angle-up" aria-hidden=true></i></button><footer class=footer-area><div class=footer-top><div class="container section"><div class="columns is-mobile is-multiline"><div class="column is-full-mobile is-one-third-desktop is-one-third-widescreen is-one-third-tablet" data-aos=fade-up><div class=single-footer-widget><div class=footer-logo><a href=https://appscode.com><img src=/assets/images/products/appscode/appscode.png alt=AppsCode class=img></a></div><div class=subscription-form><form method=post action=https://listmonk.appscode.com/subscription/form id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=navbar-form target=_blank novalidate role=email role=email><label for=email>Subscribe to Our Newsletter</label><p class=spam-message>No spam, we promise. Your mail address is secure</p><div class="field has-addons"><div class=control><input type=hidden id=afbbc name=l value=afbbc974-e163-4467-be49-040e399520f3>
<input class=input name=email id=mce-EMAIL type=email placeholder="Your work email address" required>
<button id=mc-embedded-subscribe type=submit name=subscribe class=button>
<i class="fa fa-paper-plane-o" aria-hidden=true></i></button></div></div></form></div><div class=contact-information><h4>Have any Inquiry?</h4><ul class=all-contact-info><li><a href=callto:+1%28650%29241-8486><span><i class="fa fa-phone" aria-hidden=true></i></span>+1(650)241-8486</a></li><li><a href=mailto:support@appscode.com><span><i class="fa fa-envelope-o" aria-hidden=true></i></span>support@appscode.com</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=500><div class=single-footer-widget><div class=footer-menu><h4>Products</h4><ul class=footer-link><li><a href=https://kubedb.com>KubeDB</a></li><li><a href=https://stash.run>Stash</a></li><li><a href=https://kubevault.com>KubeVault</a></li><li><a href=https://kubeform.cloud>Kubeform</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=600><div class=single-footer-widget><div class=footer-menu><h4>Services</h4><ul class=footer-link><li><a href=https://appscode.com/pricing/>Pricing</a></li><li><a href=https://appscode.com/consulting/>Consulting</a></li><li><a href=https://appscode.com/training/>Training</a></li><li><a href=https://appscode.com/support/>Support</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=700><div class=single-footer-widget><div class=footer-menu><h4>Company</h4><ul class=footer-link><li><a href=https://appscode.com/about/>About Us</a></li><li><a href=https://blog.byte.builders>Blog</a></li><li><a href=https://appscode.com/contact/>Contact Us</a></li></ul></div></div></div><div class="column is-half-mobile" data-aos=fade-up data-aos-duration=800><div class=single-footer-widget><div class=footer-menu><h4>Legal</h4><ul class=footer-link><li><a href=https://appscode.com/legal/tos/>Terms of Sevice</a></li><li><a href=https://appscode.com/legal/privacy-policy/>Privacy Policy</a></li><li><a href=https://appscode.com/legal/security/>Security</a></li><li><a href=https://appscode.com/legal/sla/>Service Level Agreement</a></li></ul></div></div></div></div></div></div><div class=footer-bottom><div class="container section"><div class=columns><div class="column is-4"><p>© 2021 AppsCode Inc. All rights reserved.</p></div><div class="column is-4 is-mobile has-text-centered"><div class=footer-inline-link><a href=https://appscode.com/legal/privacy-policy/>Privacy Policy</a>
<a href=https://appscode.com/legal/tos/>Terms of Service</a></div></div><div class="column is-4 is-mobile has-text-right"><div class=socail-link-inline><ul><li><a href=https://twitter.com/AppsCodeHQ><i class="fa fa-twitter" aria-hidden=true></i></a></li><li><a href=https://www.facebook.com/appscode><i class="fa fa-facebook" aria-hidden=true></i></a></li><li><a href=https://www.youtube.com/c/AppsCodeInc><i class="fa fa-youtube" aria-hidden=true></i></a></li></ul></div></div></div></div></div></footer><script src=/assets/js/bulma-carousel.min.js></script><script src=https://unpkg.com/aos@2.3.1/dist/aos.js></script><script src=https://unpkg.com/downloadjs@1.4.7/download.min.js></script><script src=https://unpkg.com/clipboard@2/dist/clipboard.min.js></script><script src=/assets/js/main.js></script><script type=text/javascript id=hs-script-loader async defer src=//js.hs-scripts.com/9255943.js></script><script type=text/javascript>var Tawk_API=Tawk_API||{},Tawk_LoadStart=new Date;(function(){var a=document.createElement("script"),b=document.getElementsByTagName("script")[0];a.async=!0,a.src='https://embed.tawk.to/5821e34b18d9f16af02864b7/default',a.charset='UTF-8',a.setAttribute('crossorigin','*'),b.parentNode.insertBefore(a,b)})()</script></body></html>